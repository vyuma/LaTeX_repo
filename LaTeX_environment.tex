\documentclass{ltjsarticle}
% ltjsarticle: lualatex 用の 日本語 documentclass
% 他のタイプセットエンジンを使ってビルドする場合は、
%  \documentclass[dvipdfmx]{jsarticle} などとする。

\usepackage{url}
\usepackage{bxtexlogo} % platex, lualatexのロゴを使うために必要
\usepackage[hidelinks]{hyperref}
\begin{document}

\title{最強の\LaTeX 環境構築 Windows版}
\author{yuma, リュカ}
\date{\today}
\maketitle
\section{序文}
\subsection{編集方針}

曖昧さを排除したできるだけ再現性の高い\LaTeX 
\footnote{日本では「ラテフ」と読むことが多い。たまに「レイテック」「ラテック」派がいる。}
環境構築に対する処方箋を書きたいという思いでこの資料を書いた。
しかし環境構築後にも難関が待ち受けている。
そのために環境構築後の設定の変更等にも配慮して資料を工夫した。
\begin{itemize}
  \item \LaTeX を使えるようになりたい。さらに高性能エディターで書きたい。
  \item 自分がものすごく苦労した環境構築を1日でかつ理解しながら終わらせたい。
  \item さらに、その先を自分で学習できるようにしたい。
  \item 苦労した環境構築の記憶をとどめておいてまた困った時に見返したい。
  \item 大学1年生にも分かりやすく伝えたい
\end{itemize}
そこで初心者に\LaTeX を使えるように、さらには自分好みにカスタマイズできるようになってもらうための資料とすることを編集の基本方針としたい。

この文章は、\LaTeX をVisual Stadio Code (以下VS Code)での環境構築のために自分が
したことのすべてを書いている。技術的解説もできるだけするように努めた。
実は\LaTeX の環境構築方法を完全に技術的側面にも触れてしっかりVS Code上
に入れるための方法を体系的にまとめた資料はネットには
存在しない可能性がある。もちろん分かりやすくまとめたサイトはたくさんあるが
玉石混交である。そのために、VS Code 設定と、\LaTeX 設定の両面のアプローチ
から環境構築設定を解説したいと思った。
可能な限り初心者に分かりやすくそして自分が忘れないように書いたつもりである。
この資料が\LaTeX に入門する一助となれば筆者としても幸甚の極みである。

\subsection{この資料の特徴}
この資料は、\LaTeX の解説書ではない。VS Codeで\LaTeX 文書を編集するために必要なIT知識と
設定の方法を述べる。そのあとVS Codeの基本機能について説明する。
美文書書作成入門\cite{美文書本}は、\LaTeX の機能の解説については大変充実した良書ではあるものの、環境構築についてはあまり触れていない。またほかのサイトなどを探しても、IT知識が
少しでもないとまったく分からない。そのためにシステムをいじりたくなくなるし、さらに取り返しのつかなくなることがまれにある。この状況を回避するために
この資料を作った。

しかし、この資料にも至らぬ点が山ほどあると思われる。
自分もすべてを理解しているわけではない。
この資料の記述は自分がおこなってできたことだけを記述している。
それ以外のことを知りたい場合は、付録の参考文献やLaTeX workshopのreadmeを
読むとよい。

\subsubsection{設定用コード等について}
設定用コードは、コピー＆ペーストの利便性も考えてVS Code で使えるmarkdown形式のファイルにした。これはこの資料とともに使われることを想定したものである。


\subsection{この資料の読み方}
この資料は、細かな説明などは意図せずに省かれている可能性があるため、製作者のもとでこの資料を使う形式を想定している。したがってそれ以外の場合での利用は自分で参考文献等を読まれることを強くオススメする。資料制作者の立ち合いのもとでの教授のあと使用するという形式でも十分使える資料になっている。

\subsection{免責事項}
この資料を使ったことによる損害等は、製作者は一切の責任を負いません。
この資料に関する質問などは学術サーバー内でおこなっています。

\tableofcontents
\clearpage

\part{導入}
\section{\LaTeX , VS Code とは何か？}
\subsection{\LaTeX とは何か？}
\LaTeX とは、文書執筆ツールとして使われる、組版処理系の一つである。
\LaTeX を使う利点をいくつか挙げる。
\begin{itemize}
  \item 数式がきれいに書ける
  \begin{itemize}
    \item Wordで書こうとするととんでもない数のクリックと精密なエイム力を要求される
    \footnote{これは決してWordを貶しているわけではない。そのようにWordを使うことが間違っているのである。Wordも\LaTeX も同じ文書執筆ツールではあるが、それぞれに長所短所があり使うべき場所というものがある。}
  \end{itemize}
  \item 見た目と論理構造を分離できる
  \item 修正、再利用が容易
  \item gitでバージョン管理できる
  \begin{itemize}
    \item 共同編集が可能
  \end{itemize}
  \item 数学系、物理系では論文執筆のデファクトスタンダード
  \item 貧弱なスペックのパソコンでも編集作業がやりやすい
  \item 無料
\end{itemize}
VS Codeの機能を使ってテンプレートを作っておけば簡単に体裁の整った文書を作成でき、内容のみに集中して執筆することが可能になる。
数式交じりのレポートを作成するときなど、大学生1年生でも恩恵を受ける場面は多いはずである。

\LaTeX と関わりの深い言葉として\TeX があるが、この2つはまったく違うものであることを注意しておこう。
\footnote{\TeX はプログラム言語であり、\LaTeX は\TeX を用いて記述されたソフトウェアの集合体である。\LaTeX は数多くのソフトウェアが組み合わさって一つの文書を出力する。}
たまに口頭でテフということもあるが、ユーザーが見える範囲で\TeX があらわれることはほとんどなく、大方\LaTeX のことを指していると考えてよい。
このあたりの話は美文書書作成入門\cite{美文書本}に詳しい。

この資料では、ローカル(手元のPC)に\LaTeX をインストールし、
VS Codeで編集ができる環境を整える。
インストール不要な環境を提供するサービスにLaTeX works editerやcloud LaTeX というものもあるが、両者を使って比較してみると、カスタマイズ性の高いローカル環境の威力がわかると思う。

\subsection{VS Code とは何か？}
VS Codeとは、Visual Stadio Code の略でマイクロソフト社が提供する
統合開発環境である。要は高性能なエディターであり、後述する拡張機能の存在によって\LaTeX との親和性も高い。
VS Codeは、
\begin{itemize}
  \item 無料で頒布されている
  \item 動作が軽い
  \item クロスプラットフォームである（さまざまなOSに対応している）
  \item 最新トレンド全部入り
  \item 拡張がしやすく、さまざまな機能がある
\end{itemize}
という特徴がある。

\section{\LaTeX に慣れる}
美文書作成入門\cite{美文書本}や一週間で\LaTeX の基礎が学べる本
\cite{一週間基礎}等を用いて、\LaTeX にふれることで
この後の流れが少し分かりやすくなるかもしれない。
そこで、環境構築せずとも\LaTeX が使える環境としてcloud LaTeX 
について解説する。

\subsection{cloud LaTeX の使い方}
cloud LaTeX は、オンライン上で\LaTeX を扱うことができる。
環境構築をすることなくすぐに\LaTeX 文章を書くことができるという点は、
\LaTeX の記法に慣れるという面では、有用である。したがってこの章では、cloud LaTeX の
使い方について簡単に説明して\LaTeX に慣れてもらいたい。
初めに
\url{https://cloudlatex.io/ja}
のサイトに行きユーザー名やメールアドレスと任意のパスワードを設定する。
すると設定したメールアドレスにメールが来るので、メールアドレスの受信確認
をクリックする。アカウント登録が完了する。
マイページから、新規プロジェクトの追加を選んで\LaTeX 文書を書き始めることが
できる。
cloud LaTeX はVS Code と同等の機能があるので最初に使うにはとてもいい教材である。データはすべてcloud LaTeXのサーバ上に保存されるのでデータが消える心配はほとんどない。また、共同作業も可能である。
しかし、共同作業をより効率的に行いたい場合は、Overleaf のほうが優れている可能性もある。
OverleafはGitHubと連携することができるために論文執筆の際に有効となる。
どちらがいいかは個人によるが、すぐに始めるならばcloud LaTeX をオススメする。

\part{環境構築}
\section{ローカル環境構築の基本用語}
\subsection{\LaTeX 環境設定用IT用語の理解}

\begin{description}
  \item [環境] ~\\
    \LaTeX が機能するための設定やハードソフト等の存在や設定などを
    合わせて環境という。
  \item [ローカル] ~\\
    オンライン上ではなくパソコンのこと。ローカル環境とは
    自分のパソコンの環境のこと。
    % ローカル：手元にある(ネットワークを介していない)
    % リモート：(ネットワークを介して接続できる)離れたところにある
    % ローカルの対義語はオンラインではなくリモートになります
  \item [ユーザー] ~\\
    自分が設定した名前 自分のこと
    ユーザーの名前のフォルダーが最上位にあると考えておけばよい。
    % Windowsはユーザーアカウントを用いて、PCを使用するユーザー(利用者)を識別しています。また、ユーザーごとにホームディレクトリが割り当てられているため、ユーザーごとの設定に利用されることがあります。

    %  ホームディレクトリは C:/Users/ユーザー名/
    %  ルートディレクトリは C:/
    %  のことを指し、最上位にあるのはルートディレクトリです。

  \item [デフォルト] ~\\
    初期設定のこと。
  \item[拡張子] ~\\
    ファイルの種別を示す。
  \item [隠しファイル] ~\\
    エクスプローラー（よくファイルを使う場所）
    からは見えないファイル。たとえば、.latexrc 等の.の前に
    何もついていないファイルのこと。
    開き方 エクスプローラーを開いて上にある表示タブ
    を開いて表示タブにする。表示タブから隠しファイルを開いて、
    チェックマークをつける。これにより、
    今まで見えなかったファイルが見えるようになる。
    % .から始まる名前のファイル、フォルダをそれぞれ隠しファイル、隠しフォルダと呼びます。
    % 先頭の.と、ファイル名と拡張子の間にある.は意味が異なるため両方あることもあります。
    % 例えば、.sample.txtのようなファイルも隠しファイルになります。
    % .から始まる名前のファイルのことをいう。
    % .から始めるものはlinuxだとオプションを明示しない限り表示されない(ユーザーが関与しないファイルをおく)

  \item [ディレクトリ] ~\\
    ファイルが入っている階層を指し示す言葉。
    階層のことであり、
    日本語の意味では住所録の意味。ドライブ直下に置くとは、
    最上部のフォルダーの中に入れることを意味する。
    ファイルの現在位置を指し示す言葉で、ルートディレクトリとは、
    フォルダーの階層の最上位のフォルダーを意味する。
    % ディレクトリとフォルダはほぼ同じ意味です。
    % ルートディレクトリは C:/ のことを指します。
    % またドライブが複数ある場合はそれぞれにルートディレクトリがあります。

    % 「ドライブ直下に置く」は「ドライブ」と「直下に置く」という未定義語が2つあるので、例として適切ではないかと思います。    

    ここで注意! \LaTeX や、その他のプログラミング言語は
    日本語つまり全角のファイル名は、探すことができない。
    エラーを出す。このため、すべてのファイル名や、
    パソコンでの設定した名前は、かならず半角英数字にすること
    を覚えておく必要がある。
    % 全角文字だけでなく半角スペースもエラーの原因となりうることを注意しておきましょう
    % ただ、LaTeXでもパスに全角文字を含むだけであれば、オプションを適切に設定すれば正常にコンパイルすることができます。
    % とはいえエラーを避けるためにも、半角英数字でファイル名、ディレクトリ名をつけることをおすすめします。
    % 英語表記する、スペースはアンダースコア(_)あるいはハイフン(-)に置き換える、などの方法があります。

  \item [パス] ~\\
    ディレクトリでそのファイルの住所位置を
    指定するもの。
  \item [プロジェクトルート] ~\\
    ディレクトリの一番初めに存在する
    それより上のファイルが存在しない領域
    % プロジェクトルートは、アプリケーションによって様々な意味で使われます。
    % ディレクトリの一番初めは、ルートディレクトリという呼び方が一般的です
  \item [グローバル] ~\\
    すべてのユーザーやそのアプリケーション内ですべてに設定
    されるような設定のこと。
    % グローバルとは、全体的な、すべての、という意味です。
    % 説明の内容がユーザー設定などと対比したときのグローバル設定の説明になっているので、「グローバル」の説明としては不適切かと思います。
  \item [コマンドプロンプト] ~\\
    Windowsの操作をコマンドでおこなうためのシステム。
    \begin{description}
      \item[開き方1] ~\\
      コマンドプロンプトをスタートメニュー（Windowsアイコンのタブ）
      の中の検索窓からコマンドプロンプトと打ち、マウスで出てきた
      コマンドプロンプトをクリックする。
      \item[開き方2] ~\\
      Windowsキー+R で「ファイル名を指定して実行」という窓が出てくる
      のでその指定する窓にCmd と打ち Enterを打つことで、
      コマンドプロンプトを実行できる。
    \end{description}
    % エクスプローラーのパスの入力欄に"cmd"と入力してEnterを押すことでもコマンドプロンプトを開くことができます。
    % このようにして開いた場合、カレントディレクトリは"cmd"の入力前にエクスプローラーのパスの入力欄に表示されていたディレクトリになります。
    % そのためカレントディレクトリを移動する手間が減ります

  \item [リポジトリ] ~\\
    プロジェクトを構成するプログラムのソースコードやドキュメント、
    関連する各種のデータやファイルなどを一元的に管理する格納場所のこと
    % ほぼgitでしか使わない用語なので、gitの説明に移動したほうがよいかと思います。
    % もしgitの説明もするのであればコミット、プッシュといった用語と共に説明したほうが分かりやすいのでは。
\end{description}

\subsection{\LaTeX 用語の理解}
\begin{description}
  \item [ビルド] ~\\
    \LaTeX では、記述したソースコードに問題がない
    かどうかの解析を行い、問題がなければ実行可能なファイルに変換すること。
    % LaTeXはあらかじめソースコードの解析を行っているわけではなく、
    % ファイルを上から順番に読んでできるだけの処理を行い、問題があればエラーを出力して終了します。

    % またビルドという言葉は一般には(C言語などの文脈では)実行可能なファイルに変換することという意味で使われますが、LaTeXはLaTeXソースコードから文書ファイルを出力すること、という若干特殊な意味で使われます。
    % pdfファイルは実行可能なファイルではありません。
  \item [コンパイラ] ~\\
    コンパイラとは機械が読み取れる言語に移すことのできるソフトウェア等のこと。
  \item [コンパイル] ~\\
    ソースコードを機械が翻訳できる言語に移すことで、ビルドの中の一連の作業に入っている。
    % コンパイラ、コンパイルもC言語などとLaTeXでは意味が異なります。
    % この説明はC言語などで使われる意味の説明になっているため、LaTeX用語の説明としては不適切かと思います。
  \item [プリアンブル] ~\\
    \verb|\documentclass|から\verb|\begin{document}|までの中にある設定のこと。
\end{description}
\section{エクスプローラーの設定}
拡張子と隠しファイルを表示するように設定する。
\begin{enumerate}
  \item エクスプローラーを起動する。
  \item 拡張子を表示したいフォルダを開き、メニューの「表示」タブをクリックする。
  \item さらに[表示]を選択し、「ファイル名拡張子」「隠しファイル」にチェックを入れる。
\end{enumerate}
ファイル名の後ろに.txt等のファイルの種類を示す文字列が表示されるようになり、今まで見えなかったファイルが見えるようになる。

% \begin{description}
%   \item[windows 10] ~\\ 
%     エクスプローラーを開いて上にある表示タブ
%     を開いて表示タブにする。表示タブから隠しファイルを開いて、
%     チェックマークをつける。
%   \item[windows 11] ~\\
%     エクスプローラーの上部にある三点リーダーのアイコン(…)をクリックする。
%     オプションを選択してフォルダーオプションを開く。
%     タブから表示を選択して、「隠しファイルと隠しフォルダー、および隠しドライブを表示する」を選択する。OKを押す。
% \end{description}
% win10での動作確認ができないためwin11の説明としました。
\section{TeX Live導入}

\subsection{TeX Live インストール}
TeX Live は、次のページからダウンロードすると良い。
% 最小構成インストールのやり方
\footnote{
  \LaTeX はたくさんのソフトウェアからなるシステムであるため、
  配布用に必要なソフトウェア群をパッケージしたディストリビューションの形でインストールする。
  今回インストールするのはTeX Liveというディストリビューションである。
}
\\
\url{https://www.tug.org/texlive/acquire-netinstall.html}\\
をクリックして、ページ上のリンク install-tl-windows.exeをクリックする。この時、
警告が出るが無視して大丈夫。
そしてNextを押し続けてinstallを押す。これで、\LaTeX packageのほとんどすべてを
ダウンロードすることが可能。

\subsubsection*{インストールが正常に行われたことを確認する}
インストール完了後、コマンドプロンプトを起動して、\verb|latex -v|と打ち込む。
この時に、$3.141592653$のようなversion情報が出てこれば正常に完了している。
\footnote{
  これは、\TeX 製作者Donald E.Knuth教授の意向で
  version up ごとに円周率$\pi$へ近づいて行く。
}

\section{Visual Stadio Code の導入}
\subsection{Visual Stadio Code のインストール}
Visual Studio Code は次のページからダウンロードするとよい。\\
\url{https://code.visualstudio.com/download}\\
をクリックしてそのあとの画面の中から今回の場合は、
自分の環境に合わせて (Windows か Mac の) ファイルをダウンロードする。
ファイルを開き、追加タスクの変更は触らないようにしてNextを押し続ければ
インストールできる。
\subsection{VS codeの日本語化}
VS Codeをショートカットから開いて、積み木のようなアイコンExtentions（拡張機能）
をクリック。検索窓にJapaneseと打って、
Japanese Language Pack for Visual Studio Code
を選択してインストールする。これで日本語化が完了する。

\section{latexmkの導入} 
\subsection{latexmkとは}
\LaTeX 文書を手動でコンパイルしようとすると複数種類のコマンドを適切な順番で複数回実行しなければならない。latexmkとは、各種\LaTeX のビルドコマンドを自動で一括で実行してくれるツールである。

\subsection{latexmkの設定}
ホームディレクトリ
\footnote{
  PC>ローカルディスク>ユーザー>ユーザー名、と辿れるディレクトリのこと
}
直下に\verb|.latexmkrc|というテキストファイルを作成し、テキストエディタで開く。
markdownファイルに記載された設定をコピーして貼り付け、保存する。

% jlistingsで設定ファイルを貼り付け
% つまりルートフォルダーにこのファイルを保存するということ。
% // ホームディレクトリは C:/Users/ユーザー名/
% // ルートディレクトリは C:/
% // のことを指し、両者は異なります。
\subsection{latexmkの設定の解説}
% wip

\section{LaTeX workshopの設定}
VS Codeの設定は、setting.json
\footnote{.jsonはジェイソンと読む}
というファイルに記載されている。
setting.json を開く方法はいくつかある。
\begin{description}
  \item[1つ目] ~\\
    VS Code左下の設定マーク（歯車マーク）をクリックして、「設定」を選択する。
    右上端にあるファイルに矢印がついたアイコンをクリックする。
  \item[2つ目] ~\\
    キーボードのショートカットキーを用いて、ctrl+shift+P と入力することで、
    コマンドパレットを出現させてそこにPreferences:Open User Setting
    と打ち込む。
  \item[3つ目]~\\
    Ctrl+ , で設定画面を開く。さらに右上端にあるファイルに矢印がついたアイコンをクリックする。
\end{description}
の2つの方法があり熟練したら2番目の方法の方が効率が良い。
% // そう頻繁に編集するものではないので、1つ目の方法でいいと思います。

% .json はJavaScript に対応している。
% // JavaScript に触れる必要はないのでは？
setting.json を開いたら、\verb|{}|の中にmarkdownファイルに記載された設定をコピーして書き加え、保存する。
% jlistingsで設定ファイルを貼り付け
% なお、platexの設定についてはすでに書き換えられたものを提示する

もし開いた時点で\verb|{}|以外に何か書き込まれていた場合、\verb|{}|の最後の要素にコンマをつけて、設定をコピーして書き加え、保存する。
\subsection*{LaTeX workshopの設定の説明}

% \subsection{\pLaTeX のコンパイルについて}
% \pLaTeX のコンパイルについて
% \pLaTeX に関する設定だけは、うまくいかないので下のように書き換える。
% \pLaTeX  のところの
% recipe tools の変更をおこなう。
% setting.jsonのlatex-workshop.latex.toolsのところに次のように書き換える。

と書き換えれば良い。
% どこを指しているか分かりませんでした...

\subsection{自動ビルド機能の設定}
\begin{verbatim}
	"files.autoSave": "afterDelay", 
  "latex-workshop.latex.autoBuild.run": "never",
\end{verbatim}
% autoSaveも含めた解説にする
は、自動ビルド機能である。しかし、自動ビルドは、
このファイルのように大きすぎると非常に重くなってしまう。
\LaTeX は、コンパイルと、書くことを分離することで、
高度なレイアウトの最適化を可能にしている。
% 書く必要量をへらしているために
これはneverにしておくことをオススメする。
% 自動保存機能とともに紹介すると納得しやすいかもしれない。

\section{ローカル環境でビルドする}
次の\LaTeX の文章を入力する。これは\LuaLaTeX 用のソースコードである。
% jvlistingでコードを貼り付ける


\part{\LaTeX 解説}
\section{\LaTeX の基本機能の設定}
\LaTeX の特徴の一つに文書の論理的構造と視覚的なレイアウトを分けて考えることができることがある。
例えば、「はじめに」という名前の節があれば文書に\verb|\section{はじめに}|と書いておく。
この文書をコンパイルするに際し、
\verb|\section{...}|という命令がどのような見た目になるかはスタイルファイルに記述されており、それを元に目的のファイルが生成される。
\LaTeX はこのような構成をしているため文章を書くときはデザインのことを考えずに済むし、デザインを変えたいときはスタイルファイルを変更するだけで済むのである。

我々が\LaTeX で文書を作る時には、この利点を最大限に享受するため、
直接見た目を指示するような命令はなるべく使わないようにするべきだろう。

% \LaTeX の基本精神は、人間は、内容に集中して \LaTeX はデザインに
% 集中するという使い方をすること。余計な装飾はできるだけ避けるのが無難。

\subsection{コンパイル}
\begin{itemize}
  \item ctrl+Alt+Bのショートカットキーでおこなう。
  \item VS Code右上の緑色の三角マークをクリックして行う。
  \item 左のタブのBuild LaTeX project の中のRecipe:からおこなう。
\end{itemize}
ただし、今回の設定では、上の2つの方法でコンパイルすると\LuaLaTeX
で出力される。このために、\pLaTeX などを使いたい場合は、
左のタブからおこなう必要がある。

\section{エラーメッセージを読む}
LaTeX workshop ではエラーがメッセージで表示されるがそれを
初心者はなかなかうまく使いこなせない。
そこでエラーの読み方と対応策を考える。

\subsection{Recipe terminated with error}
おそらくLaTeX Workshop を使ってはじめて見るだろうエラー。
このエラーは、\LaTeX 側のエラーではない。\LaTeX のエラーは、
Ctrl+Shift+M のショートカットキーで表示される。
これは、注意が出ている時にも使うことができる。

\subsection{Recipe terminated with error. Retry building the project.}
このエラーというよりかは警告なのだがこれも本質的に意味がない。

\subsection{意味のあるエラーメッセージ}
意味のあるエラーメッセージは、出力される'問題'のログかまたは、``*.log''
という\LaTeX のコンパイルの際に使われる中間生成物のファイルである。
今回のデフォルト設定では、このファイルは削除されるため出てこないが、
エラーが特定しやすくするためには、残しておいた方が良いときもある。
%そもそもLaTeXは最近のソフトウェアのような洗練されたエラーメッセージを出力しないため、それを前提とした VS Code のエラーハンドリング機能との相性は良くない。
% エラーポップアップやコンソールの問題タブなどを見るよりも、エラーメッセージ全文から探したほうが効率がよいと思われるため、個人的には出力タブをスクロールして確認することをおすすめしたい。
% c:/<path>:xxx: Undefined control sequence.
% l.xxx ...<エラー直前のソース>
%                                <エラー位置のソース
% みたいな感じの部分を探し、エラーメッセージの部分(この場合"Undefined control sequence.")をググると、大体は偉大な先人が残してくれた解決策が見つかる。

\section{新規packageの導入}
新規パッケージつまり、インターネット上や、
自分で作ったスタイルファイル等を使いたいときに、めんどくさいことになる。
パッケージファイルの拡張子は``.sty''であり、
このパッケージを適切な場所に配置しなければならない。
しかし、``.sty''が入っていない場合がある。これに対処するためには次セクション

\subsection{``.sty''ファイルが入っていない場合}
``.ins''ファイルが重要になる。
このファイル形式は、パッケージ本体と``.ins''ファイルが入っている.dtxを
\LaTeX で.dtx ファイルを実行する必要がある。\\
たとえばtools.ins というファイルがあった場合には、.dtx ファイルを
同じディレクトリに保存する。次に
コマンドプロンプトを起動して、以下のように、入力する。
\begin{verbatim}
  latex tools.ins
\end{verbatim}
すると、同じフォルダー内に.sty ファイルが生成される。
この.styファイルの保存場所は、次セクション参照。

\subsection{TeX Directory Structure とは何か？}
\LaTeX のパッケージなどは、TDS（TeX Directory Structure）にしたがって各
ディレクトリに配置されている。
今回はTeX Liveなので、エクスプローラーからwindowsフォルダーの中の
texlive フォルダーの中の2022年フォルダーの中のtexmf-distの中のtexの中の
latexフォルダーの中に各パッケージのフォルダーがあり、
その中に各スタイルファイルフォルダーが保存されている。といった構成に
なっている。
これは非常に見にくいし、読みにくいので、ここからは、これを
\begin{verbatim}
  C:\texlive\2022\texmf-dist\tex\latex
\end{verbatim}
のように書くと簡便になる。
そしてこれがWindowsのディレクトリの記述の仕方である。
この中のtexフォルダーにはたくさんのフォルダーがあるが、
最初に覚えておくべきは2つで、
\begin{center}
  \begin{tabular}{ll} 
    \hline
    folder名  & 意味                                \\ 
    \hline
    tex       & TeXの操作に関するフォルダーで、latex フォルダーがある。\\
    font      & フォントにかかわるフォルダー。                  \\ 
    \hline
  \end{tabular}
\end{center}
であり、このことから、.styファイルの保存場所は、
\begin{verbatim}
  C:\texlive\2022\texmf-dist\tex\latex
\end{verbatim}
よりも下のファイルに加えれば良いことがわかった。
フォントファイルについては、以下参照。
\url{https://texwiki.texjp.org/?TeX%20%E3%81%AE%E3%83%87%E3%82%A3%E3%83%AC%E3%82%AF%E3%83%88%E3%83%AA%E6%A7%8B%E6%88%90}

\subsection{パッケージを使うための一覧表の更新}
texlive環境では、上のように.styファイルを保存しても動かない。これは、
ls-Rというファイルが存在していてこれが、TeXが必要なパッケージを探すための
パスを与えている。そのために、この一覧表を更新しなければならない。
このためには、コマンドプロンプトを開き、次のように命令するだけでいい。
\begin{verbatim}
  mktexlsr
\end{verbatim}
と入力することで一覧表を更新することができる。

\subsection{使用するべきpackage}
packageは最小構成でおこなうべきである。
なぜなら、\LuaLaTeX はかなり最近のものであり、packageが\LuaLaTeX に
対応していないということもかなりの可能性としてある。
そのため、参考になるのは参考文献のサイト

% \section{TeX Live の更新について}
% tlmgr についてできたら追記


\part{VS Code 解説}
\section{VS Codeの基本機能}
デフォルトで使えるVS Codeの基本機能を解説する。
\subsection{、。を, . にする<置換機能>}
VS Codeの基本機能として、置換機能がついている。このためマクロを組まずとも
、を, に変えることができる。
コマンドは、Ctrl+Hキーを押すと検索と置換が出てきて、Enter キーを押すと
ひとつづつ置換、Crl+Alt+Enter キーを押すとすべてが置換される。
また置換を閉じるのはEsc キーである。

\subsection{コメントアウト}
\LaTeX は\verb|%|から行末までをコメントと認識する。しかしこれをいちいち書くのは面倒くさい。
さらにプログラム言語によりコメント機能はまったく違う。この時に、Ctrl+/ を
使うことで、その時に編集しているプログラム言語に応じて適切な構文でコメントアウトすることができる。

\subsection{各種ショートカット}
\begin{center}
  \begin{tabular}{ll} 
    \hline
    ショートカットキー  & 機能                      \\ 
    \hline
    Ctrl+Alt+B          & ビルドを実行する          \\
    Ctrl+Alt+V          & pdfviewer を起動する      \\
    Ctrl+click          & SyncTeXの利用（pdf側）    \\
    Ctrl+Alt+J          & SyncTeXの利用（コード側） \\
    Ctrl+Hキー          & 置換パレットの表示        \\
    Crl+Alt+Enter       & 置換の全置換              \\
    Ctrl+/              & 行のコメントアウト機能（全言語共通） \\
    Ctrl+@              & VS Codeのターミナルの起動 \\
    Shift+Alt+F         & latexindentを実行する     \\
    Ctrl+Space          & コード補完を再表示        \\
    Ctrl+Shift+ \verb|+| or \verb|-| & ズームの程度を調整する  \\ 
    \hline
  \end{tabular}
\end{center}
ただし、ショートカットキーによってビルドした場合は、
Build LaTeX projectの最初に記述されているコマンドをビルドコマンドとして呼び出す。
これらのショートカットキーはデフォルトで設定されているもので、好きなキーに変更することもできる。

\section{VS Codeの設定について}
\subsection{VS Code の設定について}
VS Codeの設定は、setting.jsonというすべてに適応される設定と、workspace設定という、workspaceと呼ばれるファイルを何個か入れた空間について設定ができる。さらにファイルごとにも設定ができる。この優先順位は、setting.json 、work space 設定、ファイル設定の順に高い。これの設定のおかげで、さまざまな設定がおこなえるようになる。ワークスペースが1つのアプリケーションのように使うことができる。
% ユーザー設定もワークスペース設定も(ディレクトリの異なる)setting.jsonに設定を記述するため、ユーザー設定をsetting.jsonと呼ぶのは誤解の恐れがあります。
% ワークスペースの説明が必要

\subsection{wordwrap}
wordwrapとは、このエディターの中で入力している中でpdfview等にしているときに文章が見えている間で改行を自動で行ってくれる設定である。この設定は最初、自動改行しない設定になっている。この時には、書いている行が右にシフトしてしまい、マウス又は、エンドキー等で次の行にしなければならない。また見るときも水平スクロールをしなければならない。しかしこの機能を有効にすることで、自動で改行し、文章の視認性が高くなる。
% プログラミングするときも、onにしておくことをおすすめしたい。

\subsection{SyncTexを使う}
\subsubsection*{SyncTex とは何か？}
TeX のソースファイルと PDF でカーソルの位置を同期する機能のこと。
これを使えば、pdf上の表示がどのソースに関係しているかということが
すぐにわかる。

\subsubsection*{SyncTeXの設定}
SyncTeXは、ビルドするときに形成されるファイル
\verb'*.synctex.gz'を使って動作する。
今の設定では、このファイルは消去されるようになっているため、
SyncTeXを使いたい場合にはこの設定を無効化する必要がある。
具体的には、setting.jsonの
\begin{verbatim}
  "latex-workshop.latex.clean.fileTypes":
\end{verbatim}
の記述の中から、
\begin{verbatim}
  "*.synctex.gz"、
\end{verbatim}
の記述を消去すればよい。これにより、VS Codeのpdfvierにおいて、
SyncTeXが利用できるようになる。

\subsubsection*{SyncTeXの具体的な利用の仕方}
pdfviewer上でCtrl キーを押しながらマウスでコードをみたい場所におき、
左クリックすることでそのコードの位置に飛ぶことができる。
逆にコードからpdfに飛びたいときは、選択範囲をマウスで示して、または
カーソルをおいて、 Ctrl+Alt+J で飛ぶことができる。
（コマンドパレットからSyncTeXと入れてコマンドを実行させてもよい。）

\subsection{スニペット導入}
\subsubsection*{スニペットとは}
スニペットとは、コードの中で何回も使うだろうコードを少しの記述
でそれを呼び出す一連の動作のことをいう。スニペットの語源は、
短い単語のことである。

\subsubsection*{スニペットの導入}
まずスニペットを導入する。左下の歯車から「ユーザースニペットの構成」を
選択する。検索窓が出てくるので、latexと入力して latex.json を開く。
latex.json にも、\verb|{}|があるので、その中に次のコードをコピーする。
スニペットの導入は、setting.jsonとは異なるため環境を破壊することはない。
% 参照すべきコードが示されていません

と書く。たとえば、report とlatexで打つと、
reportのひな形が出てくるようになる。
このように、スニペットはプリアンブル部等
を簡単に早く書くことができるようになる。

\subsection{スニペットの書き方}
スニペットの自作フォーマットは次のように書く。
スニペットもsetting.jsonと同じように、','で各設定を区切る。
\begin{verbatim}[caption=latex.json]
	{
  "[ スニペットの名前 ]": {
    "prefix": "[ 呼び出すときのショートカット]",
    "body":[
      "[ 出力されるコードの1行目]",
      "[ 出力されるコードの2行目]",
      "...",
    ],
    "description": "[ スニペットの説明文]"
  }
  }
\end{verbatim}
のように書く。
\subsubsection*{入力値の補足}
入力値の中のコマンドに\verb|$n|というのがあるがこれは、スニペットを
記述するときに入力するためのカーソルが
次にどこにいけば良いかを入力するための引数である。
たとえば、次の例では、プログラムを載せるための環境をスニペットにより
定義している。
% 例が前と同じなので、別の例を書き忘れていませんか
\begin{verbatim}[caption=latex.json]
	{
  "[ スニペットの名前 ]": {
    "prefix": "[ 呼び出すときのショートカット]",
    "body":[
      "[ 出力されるコードの1行目 $1]",
      "[ 出力されるコードの2行目 $2]",
      "...",
      "$1"
      "",
    ],
    "description": "[ スニペットの説明文 ]"
  }
  }
\end{verbatim}

このように書いたときに、カーソルが\verb|$1|を記述した後にTabキーを押すと
\verb|$2|にカーソルが移動するように書くことができる。
また、さらに、\verb|$1|が2つあるが、これらは同じことを記述したい場合には
たとえば参照をタイトルと同じにしたい場合、両方一度に入力することができる。
さらに、bodyの末尾に\verb|""|を入れておけば、入力終了後に
次の行からすぐに書き始めることができる。


\part{VS Code 拡張機能}
\section{LaTeX workshop の設定}
\subsection{シンタックスハイライト}
シンタックスハイライトとは、\LaTeX の文章などを編集するためのコマンドに色を
つけることでその対応やコードの可読性を高めることができるVS Codeの機能である。
しかしながら、LaTeX workshopはそれに対応しているのだが
VS CodeのカラーテーマをVisual Studio Dark または Visual Studio Light
にしているとうまく機能してくれない。したがってダークテーマで
シンタックスハイライトを使いたい場合は、デフォルト設定の
Dark+ を使用するとよい。又はほかのカラーテーマならば良い。

\subsection{cloud LaTeX との連携}
cloud LaTeX を使うことでパソコン内部に\LaTeX 環境を構築しなくとも
\LaTeX を使うことができる。cloud  LaTeX は cloud LaTeX と同一のサーバー内とローカルのこのVS Codeと連携することが可能であり、それにより、ローカルとサーバーで同期ができるために非常に便利なものとなっている。

\subsubsection*{利点}
\begin{itemize}
  \item データがサーバ上で保存するためにデータが消える心配はない。
  \item コンパイルがサーバ上でおこなわれるために自分のパソコンに負荷がかからないそのために自分のパソコンではできないautobuild が可能。
  \item cloud LaTeXのシステムやインストールされたパッケージを簡単に使うことができる。
\end{itemize}

\subsubsection*{欠点}
\begin{itemize}
  \item VS Code からサーバーを立ち上げることができないために、最初にcloud LaTeX の方に入る必要がある。
  \item 定期的な対応の更新をしなければならない。
  \item ローカル上ではコンパイルできないためにオフライン状態でコンパイルできない。
\end{itemize}
等が挙げられる。

\subsubsection*{cloud LaTeX との連携をするための設定}
導入の設定は、md形式のファイルに添付されているものをsetting.jsonに入れればよい。cloud LaTeX 参照

\subsection{Ultra Math Previewの設定}
Ultra Math Previewは、LaTeX Workshopよりも強力な数式プレビューができる拡張機能である。
パッケージで定義されたコマンドもPreview することができる。
さらにユーザー定義のmathPreview を導入することができるためにLaTeX Workshop 標準のプレビューよりもより利便性が高いものになっている。


\subsection{テキスト校正くん}
テキスト校正くんは、texファイルやmdファイル等の日本語文章を校閲することができる。これはインストールするだけで利用できる。

\section{キーボードショートカットの変更方法}

% \section{Git 連携}
% VS Code はGitというバージョン管理システムと容易に連携させることができるようになっており、巨大な文書制作でのバージョン管理が行える。
% そしてGit はVS Code上のボタン操作で直感的に操作することができる。
% これはローカル環境にバージョン管理のためのリポジトリを生成できる。
% これによりバージョン管理が非常に簡単になりさらにどこを変更したのかということが
% 非常に簡単にわかる。
% したがって今までCtrl+z で前の状態に戻っていたと思うが、
% セーブするとその前以上には戻ることができなかった状況から
% これは理論的には無限の過去の状態に戻すことができる状態になる。
% なおかつローカルにもオンライン（GitHub）
% として共同作業をオンラインですることができたり、また全世界に公開して
% 共同作業ができたりする。
% このように複数人でおこなう文書やプログラミング制作で大いに役立つ機能である。
% % どんなソフトウェア、サービスであるかよりも何ができるかに力点を置いた説明になっているため、
% % 少し分かりにくいような気もするがどうだろうか？ 
% % 用語をなるべく使わないようにした説明にはなっているものの、塩梅が難しいところである。

% \subsection{Git の導入}
% git はVS Codeの3つ目のタブにある丸が3つつながっているようなタブを
% クリックするとGitの導入を促すようなものがあるのでそれをクリックして
% Git のソフトウェアをGit のホームページからダウンロードする。

% \subsection{GitHub の導入}
% GitHub はgitと連携してネット上にリポジトリを生成することできる。
% GitHub は次のサイトから自分のメールアドレスを登録するだけで無制限に使うことができる。
% \footnote{ついでに言うと学生であればProプランが無料である。ぜひ有効活用しよう。}
% \url{https://github.com}

% \subsection{latexindent}
% \LaTeX のソースを自動で成形してくれるツール。これは、ソースに自動で空白等を
% 入れてくれる環境がTeX Liveにデフォルトで入っている。
% latexindent はVS Code上で、shift+Alt+Fをするとできる。
% これはitemize環境等に空白を入れて見やすくする機能がある。
% 下調べができたら追記

% \part{markdownk解説}
% \section{markdownとは何か？}
% この資料の付録は、markdown記法により書いている。markdownとは、\LaTeX と同様のマークアップ言語である。この言語はhtml記法と同じような性質を持つが記法をマスターするために必要な覚えるべきコマンドが非常に少ない。
% markdownの特色には
% \begin{itemize}
%   \item 手軽に文章構造を明示できること
%   \item 簡単で、覚えやすいこと
%   \item 読み書きに特別なアプリを必要としないこと
%   \item それでいて、対応アプリを使えば快適に読み書きできること
% \end{itemize}
% などがある.Markdownはジョン・グルーバー（John Gruber）によって2004年に開発され、最初は \url{http://daringfireball.net/projects/markdown/} で公開された。その後、多くの開発者の手を経ながら発展した。
% LaTeXのインストールとは無関係なので別ファイルに記述する

\section{markdownとtexファイルの変換}

\appendix
\section{ショートカットキー一覧}
\begin{center}
  \begin{tabular}{ll} \hline
    コマンド            & 機能                     \\ 
    \hline
    Alt+Z               & wordwrapの変更           \\
    Ctrl+Alt+B          & ビルドを実行する         \\
    Ctrl+Alt+V          & pdfviewer を起動する     \\
    Ctrl+click          & SyncTeXの利用（pdf側）   \\
    Ctrl+Alt+J          & SyncTeXの利用（コード側）\\
    Ctrl+Hキー          & 置換パレットの表示       \\
    Crl+Alt+Enter       & 置換の全置換             \\
    Ctrl+/              & 行のコメントアウト機能（全言語共通）  \\
    Ctrl+@              & VS Codeのターミナルの起動\\
    Shift+Alt+F         & latexindentを実行する    \\
    Ctrl+Space          & コード補完を再表示       \\
    Ctrl+Shift+M        & \LaTeX のエラーメッセージを表示する   \\
    Ctrl+shift+M        & 数式環境で数式のプレビューを表示する  \\ 
    Ctrl+B              & サイドバーの表示の設定   \\
    Ctrl+Shift+\verb|+| or \verb|-| & ズームの程度を調整する    \\
    Ctrl+K F            & ワークスペースを閉じる   \\ 
    Ctrl+shift+L        &マルチカーソル(同じ文字)   \\
    \hline
  \end{tabular}
\end{center}

次の参考文献は、
この資料を書き上げるために用いた資料一覧である。
この資料を読み通すことができたならば、
きっとこれらのサイトも読むことができるだろう。
さらに便利な使い方や、自分なりの設定をすることもできるだろう。
良い\LaTeX ライフを
\nocite{*}
\bibliographystyle{junsrt}
\bibliography{refernce}

\end{document}
