\documentclass[titlepage]{ltjsarticle}
% ltjsarticle: lualatex 用の 日本語 documentclass
% 他のタイプセットエンジンを使ってビルドする場合は、
%  \documentclass[dvipdfmx]{jsarticle} などとする。
\usepackage{makeidx}
\makeindex
\usepackage{xcolor}
\usepackage{listings,jvlisting} %日本語のコメントアウトをする場合jvlisting（もしくはjlisting）が必要
%ここからソースコードの表示に関する設定
% \usepackage{lua-visual-debug}
\lstset{
	stringstyle={\ttfamily},
	commentstyle={\ttfamily},
	basicstyle={\ttfamily},
	columns=fixed,
  frame={tb},
  breaklines=true,
  columns=[l]{fullflexible},
	numbers=left,%行数を表示したければonにする
	numberstyle={\scriptsize},
  xrightmargin=0em,
  xleftmargin=3em,
  stepnumber=1,
  numbersep=1em,
	tabsize=2,
  lineskip=-0.5ex,
  backgroundcolor=\color{white}
}
\renewcommand{\lstlistingname}{ソースコード}
%ここまでソースコードの表示に関する設定
\pagestyle{headings}

\usepackage{bxtexlogo} % platex, lualatexのロゴを使うために必要
% hyperref パッケージの上位版パッケージ
\usepackage{bookmark}
% xurlパッケージはurlパッケージを含む.\url{}のみでurlをうまく処理する.
\usepackage{xurl}
\hypersetup{unicode,bookmarksnumbered=true,hidelinks,final}
% pdfにメタデータを載せる。
\hypersetup{
  pdftitle={最強の\LaTeX 環境構築},
  pdfauthor={裕磨, リュカ}
}
\begin{document}

\title{最強の\LaTeX 環境構築}
\author{yuma, リュカ}
\date{\today}
\maketitle
\section{序文}
\subsection{編集方針}

曖昧さを排除したできるだけ再現性の高い\LaTeX \index{\LaTeX}
\footnote{日本では「ラテフ」と読むことが多い。海外では「レイテック」「ラテック」派がおおい。\LaTeX の読み方については、\cite{文書システムLaTeX}を参照すること。
}
\footnote{\LaTeX はLeslie Lamport\index{Leslie Lamport}によって開発された組版システムのことである。\TeX よりもより簡単に記述できるようになっている。
}
環境構築に対する処方箋を書きたいという思いでこの資料を書いた。
しかし環境構築後にも難関が待ち受けている。
そのために環境構築後の設定の変更等にも配慮して資料を工夫した。
\begin{itemize}
  \item \LaTeX を使えるようになりたい。さらに高性能エディターで書きたい。
  \item 自分がものすごく苦労した環境構築を1日でかつ理解しながら終わらせたい。
  \item さらに、その先を自分で学習できるようにしたい。
  \item 苦労した環境構築の記憶をとどめておいてまた困った時に見返したい。
  \item 大学1年生にも分かりやすく伝えたい
\end{itemize}
そこで初心者に\LaTeX を使えるように、さらには自分好みにカスタマイズできるようになってもらうための資料とすることを編集の基本方針としたい。

この文章は、\LaTeX をVisual Stadio Code\index{Visual Stadio Code} (以下VS Code)での環境構築のために自分が
したことのすべてを書いている。技術的解説もできるだけするように努めた。

これからVS Code 設定と、\LaTeX 設定の両面のアプローチ
から環境構築設定を解説したいと思う。
可能な限り初心者に分かりやすく
そして自分が忘れないように書いたつもりである。
この資料が\LaTeX に入門する一助となれば筆者としても幸甚の極みである。

\subsection{この資料の特徴}

この資料では、\LuaLaTeX を用いて、VSCode上で編集そしてpdfの生成ができるような環境を設定することを目標とする。

この資料は、\LaTeX の解説書ではない。
VS Codeで\LaTeX 文書を編集するために必要なIT知識と
設定の方法を述べる。
そのあとVS Codeの基本機能そしてLaTeXを便利に書くためのツールをできるだけ紹介する。
美文書書作成入門\cite{美文書本}は、\LaTeX の機能の解説については大変充実した良書ではあるものの、環境構築についてはあまり触れていない。またほかのサイトなどを探しても、IT知識が
少しでもないとまったく分からない。そのためにシステムをいじりたくなくなるし、さらに取り返しのつかなくなることがまれにある。この状況を回避するために
この資料を作った。

しかし、この資料にも至らぬ点が山ほどあると思われる。
自分もすべてを理解しているわけではない。
この資料の記述は自分がおこなってできたことだけを記述している。
それ以外のことを知りたい場合は、付録の参考文献\footnote{\cite{完全導入ガイド},\cite{最高の環境latex},\cite{platex}等を参考にするとよい。このサイトから多くのことを学んだ。しかし最低限すぎるし何より必要十分な解説はなされていない。}
やLaTeX workshopのreadme\cite{LaTeXworkshop_README}を
読むとよい。

\subsubsection{設定用コード等について}
設定ファイルの内容等、必要なソースコードはこの資料中に記載するとともに、コピー＆ペーストの利便性も考えてmarkdownファイルでも提供する。


\subsection{この資料の読み方}
この資料は、細かな説明などは意図せずに省かれている可能性があるため、製作者のもとでこの資料を使う形式を想定している。したがってそれ以外の場合での利用は自分で参考文献等を読まれることを強くオススメする。資料制作者の立ち合いのもとでの教授のあと使用するという形式でも十分使える資料になっている。

\LaTeX の導入の後はこの資料がリファレンスとしても外部ツールや設定の一覧としても使えるように構成をしている。

注意として\LaTeX 構文についての記述は必要最小限度にとどめている。
したがって、より詳しい\LaTeX の構文やマクロの詳しい組み方より発展的な扱い方等は\cite{美文書本}\cite{一週間基礎}等を参照する必要がある。

\subsection{免責事項}

この資料を使ったことによる損害等は、製作者は一切の責任を負いません。

\subsection{質問対応等について}

この資料の範囲の質問は学術サーバー内のLaTeXサークルで行っています。チャンネルLaTeXサークルで質問をする際はフォーラム形式にて行ってください。

またこの資料の最新版は学術サーバー内LaTeXサークル内およびGit Hub上で随時更新予定です。

また\LaTeX に関する有用な知識やテクニック、有用なプリアンブル、外部ツールなどは是非LaTeXサークル内でのプリアンブル投稿フォーラムに寄せてください。皆さんの協力によって大学内に\LaTeX をより簡単により使えるようにそして広く普及させましょう。

この資料よりも発展的・高度な質問に関しては、\cite{TeXwiki-home}などを参照する必要がある。
\clearpage
\tableofcontents
\clearpage

\part{導入}
\section{\LaTeX , VS Code とは何か？}
\subsection{\LaTeX とは何か？}
\LaTeX とは、文書執筆ツールとして使われる、組版処理系の一つである。
\LaTeX を使う利点をいくつか挙げる。
\begin{itemize}
  \item 数式がきれいに書ける
        \begin{itemize}
          \item Wordで書こうとするととんでもない数のクリックと精密なエイム力を要求される
                \footnote{これは決してWordを貶しているわけではない。そのようにWordを使うことが間違っているのである。Wordも\LaTeX も同じ文書執筆ツールではあるが、それぞれに長所短所があり使うべき場所というものがある。}
        \end{itemize}
  \item 見た目と論理構造を分離できる
  \item 修正、再利用が容易
  \item gitでバージョン管理できる
        \begin{itemize}
          \item 共同編集が可能
        \end{itemize}
  \item 数学系、物理系では論文執筆のデファクトスタンダード
  \item 貧弱なスペックのパソコンでも編集作業がやりやすい
  \item 無料
\end{itemize}
VS Codeの機能を使ってテンプレートを作っておけば簡単に体裁の整った文書を作成でき、内容のみに集中して執筆することが可能になる。
数式交じりのレポートを作成するときなど、大学生1年生でも恩恵を受ける場面は多いはずである。

\LaTeX と関わりの深い言葉として\TeX があるが、この2つはまったく違うものであることを注意しておこう。
\footnote{\TeX \index{\TeX}はプログラム言語であり、\LaTeX は\TeX を用いて記述されたソフトウェアの集合体である。\LaTeX は数多くのソフトウェアが組み合わさって一つの文書を出力する。}
たまに口頭でテフということもあるが、\footnote{\TeX は日本では「テフ」が多いが海外では「テック」と呼ばれることが多い。}ユーザーが見える範囲で\TeX があらわれることはほとんどなく、大方\LaTeX のことを指していると考えてよい。
このあたりの話は美文書書作成入門\cite{美文書本}に詳しい。

この資料では、ローカル(手元のPC)に\LaTeX をインストールし、
VS Codeで編集ができる環境を整える。
インストール不要な環境を提供するサービスにLaTeX works editerやcloud LaTeX というものもあるが、両者を使って比較してみると、カスタマイズ性の高いローカル環境の威力がわかると思う。

\subsection{VS Code とは何か？}
VS Codeとは、Visual Stadio Code の略でマイクロソフト社が提供する
統合開発環境である。要は高性能なエディター\index{エディター}であり、後述する拡張機能の存在によって\LaTeX との親和性も高い。\footnote{テキストエディタはWindows標準搭載のメモ帳などが有名である。またTeX専用のテキストエディタとしてはTeX LiveにあるTeXworks等が有名である。この資料では今後のトレンドを考えてVSCodeへの導入を推奨する。}
VS Codeは、
\begin{itemize}
  \item 無料で頒布されている
  \item 動作が軽い
  \item クロスプラットフォームである（さまざまなOSに対応している）
  \item 最新トレンド全部入り
  \item 拡張がしやすく、さまざまな機能がある
\end{itemize}
という特徴がある。

\section{\LaTeX に慣れる}
美文書作成入門\cite{美文書本}や一週間で\LaTeX の基礎が学べる本
\cite{一週間基礎}等を用いて、\LaTeX にふれることで
この後の流れが少し分かりやすくなるかもしれない。
そこで、環境構築せずとも\LaTeX が使える環境としてcloud LaTeX
について解説する。

\subsection{cloud LaTeX の使い方}
cloud LaTeX は、オンライン上で\LaTeX を扱うことができる。
環境構築をすることなくすぐに\LaTeX 文章を書くことができるという点は、
\LaTeX の記法に慣れるという面では、有用である。したがってこの章では、cloud LaTeX の
使い方について簡単に説明して\LaTeX に慣れてもらいたい。
初めに
\url{https://cloudlatex.io/ja}\cite{cloudlatexログインページ}
のサイトに行きユーザー名やメールアドレスと任意のパスワードを設定する。
すると設定したメールアドレスにメールが来るので、メールアドレスの受信確認
をクリックする。アカウント登録が完了する。
マイページから、新規プロジェクトの追加を選んで\LaTeX 文書を書き始めることが
できる。
cloud LaTeX はVS Code と同等の機能があるので最初に使うにはとてもいい教材である。データはすべてcloud LaTeXのサーバ上に保存されるのでデータが消える心配はほとんどない。また、共同作業も可能である。
しかし、共同作業をより効率的に行いたい場合は、Overleaf のほうが優れている可能性もある。
OverleafはGitHubと連携することができるために論文執筆の際に有効となる。
どちらがいいかは個人によるが、すぐに始めるならばcloud LaTeX をオススメする。

\part{環境構築}
\section{ローカル環境構築の基本用語}
\subsection{\LaTeX 環境設定用IT用語の理解}

\begin{description}
  \item [環境\index{かんきょう@環境}] ~\\
        \LaTeX が機能するための設定やハードソフト等の存在や設定などを
        合わせて環境という。
  \item [ローカル\index{ローカル}] ~\\
        オンライン上ではなくパソコンのこと。ローカル環境とは
        自分のパソコンの環境のこと。
        % ローカル：手元にある(ネットワークを介していない)


  \item[リモート\index{リモート}] ~\\
    (ネットワークを介して接続できる)離れたところにある
    % ローカルの対義語はオンラインではなくリモートになる
  \item [ユーザー\index{ユーザー}] ~\\
        自分が設定した名前 自分のこと
        ユーザーの名前のフォルダーが最上位にあると考えておけばよい。
        \footnote{Windowsはユーザーアカウントを用いて、PCを使用するユーザー(利用者)を識別しています。また、ユーザーごとにホームディレクトリが割り当てられているため、ユーザーごとの設定に利用されることがあります。}

        %  ホームディレクトリは C:/Users/ユーザー名/
        %  ルートディレクトリは C:/
        %  のことを指し、最上位にあるのはルートディレクトリです。

  \item [デフォルト\index{デフォルト}] ~\\
        初期設定のこと。
  \item[拡張子\index{かくちょうし@拡張子}] ~\\
    ファイルの種別を示す。
  \item [隠しファイル\index{かくしふぁいる@隠しファイル}] ~\\
        エクスプローラー（よくファイルを使う場所）
        からは見えないファイル。たとえば、.latexrc 等の.の前に
        何もついていないファイルのこと。
        開き方 エクスプローラーを開いて上にある表示タブ
        を開いて表示タブにする。表示タブから隠しファイルを開いて、
        チェックマークをつける。これにより、
        今まで見えなかったファイルが見えるようになる。
        % .から始まる名前のファイル、フォルダをそれぞれ隠しファイル、隠しフォルダと呼びます。
        % 先頭の.と、ファイル名と拡張子の間にある.は意味が異なるため両方あることもあります。
        % 例えば、.sample.txtのようなファイルも隠しファイルになります。
        % .から始まる名前のファイルのことをいう。
        % .から始めるものはlinuxだとオプションを明示しない限り表示されない(ユーザーが関与しないファイルをおく)
    \item[GUI\index{GUI}]~\\
        GUIとは``Graphical User Interface（グラフィカルユーザーインターフェース）''の略であり、ユーザーの使いやすさを重視し、アイコンやボタンなどを用いて直感的にわかりやすくコンピューターに指令を出せるようにしたユーザーインターフェース\index{ユーザーインターフェース}。ユーザーインターフェースとは、ユーザーとコンピューター間での情報のやり取りの方法、仲立ちするものである。GUIではキーボードに加えてマウスなどのポインティングデバイスやタッチパネルによって視覚的に操作できる。WordやPowerPointなどがこれに当たる。
    \item[CUI\index{CUI}]~\\
        CUIとは``Character User Interface（キャラクターユーザーインターフェース）''の略である。あらかじめ決まっている文字や命令を コマンドといい、コマンドを入力してコンピュータに指示をだすユーザーインターフェース。CUIでは主にキーボードによるコマンドの文字情報のみで操作する。Windowsではコマンドプロンプトがこれに当たる。
        \item[ディストリビューション\index{ディストリビューション}]~\\
        パッケージの仕方・配布形態の異なるソフトウェアパッケージのことであり、TeXliveは日本で最も使われているLaTeXディストリビューションである。


  \item [ディレクトリ\index{ディレクトリ}] ~\\
        ファイルが入っている階層を指し示す言葉。
        階層のことであり、
        日本語の意味では住所録の意味。ドライブ直下に置くとは、
        最上部のフォルダー\index{フォルダー}の中に入れることを意味する。
        ファイルの現在位置を指し示す言葉で、
        ルートディレクトリ\index{ルートディレクトリ}とは、
        

        ディレクトリとフォルダは、
        \begin{itemize}
          \item GUIで操作するときはフォルダーという。
          \item CUIで操作するときはディレクトリと呼ぶ
        \end{itemize}
        という違いがあるのみであり指している対象としては同一のものである。

        \begin{description}
          \item[ルートディレクトリ]  フォルダーの階層の最上位のフォルダーを意味する。
          \item[ホームディレクトリ]   ユーザーフォルダーのこと。
          \item[カレントディレクトリ] 現在自分がいるフォルダーのこと。
        \end{description}


        % ディレクトリとフォルダはほぼ同じ意味です。
        % ルートディレクトリは C:/ のことを指します。
        % またドライブが複数ある場合はそれぞれにルートディレクトリがあります。

        % 「ドライブ直下に置く」は「ドライブ」と「直下に置く」という未定義語が2つあるので、例として適切ではないかと思います。    

        ここで注意! \LaTeX や、その他のプログラミング言語は
        日本語つまり全角のファイル名は、探すことができない。
        エラーを出す。このため、すべてのファイル名や、
        パソコンでの設定した名前は、かならず半角英数字にすること
        を覚えておく必要がある。
        全角文字だけでなく半角スペースもエラーの原因となりうることを注意しておく。
        % ただ、LaTeXでもパスに全角文字を含むだけであれば、オプションを適切に設定すれば正常にコンパイルすることができます。
        % とはいえエラーを避けるためにも、半角英数字でファイル名、ディレクトリ名をつけることをおすすめします。
        代替案として英語表記する、スペースを表現する方法として、スペースはアンダースコア(\verb|_|)あるいはハイフン(-)に置き換える、などの方法がある。

  \item [パス\index{パス}] ~\\
        ディレクトリでそのファイルの住所位置を
        指定するもの。
  % \item [プロジェクトルート\index{プロジェクトルート}] ~\\
  %       ディレクトリの一番初めに存在する
  %       それより上のファイルが存在しない領域
  %       ルートディレクトリという呼び方が一般的である。
        % プロジェクトルートは、アプリケーションによって様々な意味で使われます。
        % ディレクトリの一番初めは、ルートディレクトリという呼び方が一般的です
  \item [グローバル\index{グローバル}] ~\\
        すべてのユーザーやそのアプリケーション内ですべてに設定
        されるような設定のこと。
        % グローバルとは、全体的な、すべての、という意味です。
        % 説明の内容がユーザー設定などと対比したときのグローバル設定の説明になっているので、「グローバル」の説明としては不適切かと思います。
  \item [コマンドプロンプト\index{コマンドプロンプト}] ~\\
        Windowsの操作をコマンドでおこなうためのシステム。
        \begin{description}
          \item[開き方1] ~\\
            コマンドプロンプトをスタートメニュー（Windowsアイコンのタブ）
            の中の検索窓からコマンドプロンプトと打ち、マウスで出てきた
            コマンドプロンプトをクリックする。
          \item[開き方2] ~\\
            Windowsキー+R で「ファイル名を指定して実行」という窓が出てくる
            のでその指定する窓にCmd と打ち Enterを打つことで、
            コマンドプロンプトを実行できる。
            \item[開き方3]~\\
            エクスプローラーのパスの入力欄に\verb|cmd|と入力してEnterを押すことでもコマンドプロンプトを開くことができる。
        \end{description}

        % エクスプローラーのパスの入力欄に"cmd"と入力してEnterを押すことでもコマンドプロンプトを開くことができます。
        % このようにして開いた場合、カレントディレクトリは"cmd"の入力前にエクスプローラーのパスの入力欄に表示されていたディレクトリになります。
        % そのためカレントディレクトリを移動する手間が減ります

  \item [リポジトリ\index{リポジトリ}] ~\\
        プロジェクトを構成するプログラムのソースコードやドキュメント、
        関連する各種のデータやファイルなどを一元的に管理する格納場所のこと
        % ほぼgitでしか使わない用語なので、gitの説明に移動したほうがよいかと思います。
        % もしgitの説明もするのであればコミット、プッシュといった用語と共に説明したほうが分かりやすいのでは。
\end{description}

\subsection{\LaTeX 用語の理解}
\begin{description}
  \item [ビルド\index{ビルド}] ~\\
        \LaTeX では、記述したソースコードに問題がない
        かどうかの解析を行い、問題がなければ実行可能なファイルに変換すること。
        % LaTeXはあらかじめソースコードの解析を行っているわけではなく、
        % ファイルを上から順番に読んでできるだけの処理を行い、問題があればエラーを出力して終了します。

        % またビルドという言葉は一般には(C言語などの文脈では)実行可能なファイルに変換することという意味で使われますが、LaTeXはLaTeXソースコードから文書ファイルを出力すること、という若干特殊な意味で使われます。
        % pdfファイルは実行可能なファイルではありません。
  \item [コンパイラ\index{コンパイラ}] ~\\
        コンパイラとは機械が読み取れる言語に移すことのできるソフトウェア等のこと。
  \item [コンパイル\index{コンパイル}] ~\\
        ソースコードを機械が翻訳できる言語に移すことで、ビルドの中の一連の作業に入っている。
        % コンパイラ、コンパイルもC言語などとLaTeXでは意味が異なります。
        % この説明はC言語などで使われる意味の説明になっているため、LaTeX用語の説明としては不適切かと思います。
  \item [プリアンブル\index{プリアンブル}] ~\\
        \verb|\documentclass|から\verb|\begin{document}|までの中にある設定のこと。
\end{description}
\section{エクスプローラーの設定\index{エクスプローラー}}
拡張子と隠しファイルを表示するように設定する。
\begin{enumerate}
  \item エクスプローラーを起動する。
  \item 拡張子を表示したいフォルダを開き、メニューの「表示」タブをクリックする。
  \item さらに[表示]を選択し、「ファイル名拡張子」「隠しファイル」にチェックを入れる。
\end{enumerate}
ファイル名の後ろに.txt等のファイルの種類を示す文字列が表示されるようになり、今まで見えなかったファイルが見えるようになる。

% \begin{description}
%   \item[windows 10] ~\\ 
%     エクスプローラーを開いて上にある表示タブ
%     を開いて表示タブにする。表示タブから隠しファイルを開いて、
%     チェックマークをつける。
%   \item[windows 11] ~\\
%     エクスプローラーの上部にある三点リーダーのアイコン(…)をクリックする。
%     オプションを選択してフォルダーオプションを開く。
%     タブから表示を選択して、「隠しファイルと隠しフォルダー、および隠しドライブを表示する」を選択する。OKを押す。
% \end{description}
% win10での動作確認ができないためwin11の説明としました。
\section{TeX Live導入}

\subsection{TeX Live インストール}
TeX Live \index{TeX Live}は、次のページからダウンロードすると良い。
\footnote{
  \LaTeX はたくさんのソフトウェアからなるシステムであるため、
  配布用に必要なソフトウェア群をパッケージしたディストリビューションの形でインストールする。
  今回インストールするのはTeX Liveというディストリビューションである。
}

\begin{quote}
  \centering
  \url{https://www.tug.org/texlive/acquire-netinstall.html}

\end{quote}
をクリックして、ページ上のリンク install-tl-windows.exeをクリックする。この時、
警告が出るが無視して大丈夫。
そしてNextを押し続けてinstallを押す。これで、\LaTeX packageのほとんどすべてを
ダウンロードすることが可能。
フルパッケージをダウンロードすると3時間程度かかる。
% 最小構成インストールのやり方
\subsection{インストールを最短で終わらせる方法（最小構成でのインストール）}
環境構築を早く行いたい場合や、PCにメモリがない場合には環境構築の容量を大きく制限する必要がある。インターネット回線が非常に遅い場合でもインストールを最短で終わらせる方法について記述する。
\subsubsection{TeX Live インストーラーのインストール}
TeX Live インストーラーをインストールすることがまず始めにある。次に、TeX Live インストーラーで\textbf{高度な設定}をクリックする。

次にTeX Live インストーラーで\textbf{高度な設定}をクリックする。ここで最小のパッケージでインストールするために次のことに気を付ける。
\begin{itemize}
  \item 「ディレクトリ」は無変更
  \item 「選択したもの」欄で変更２つ行う。
        \begin{itemize}
          \item スキーム(インストールするパッケージの種類を大まかに決める)を変更する。basic スキームを選択。
          \item 下のカスタマイズに入り、言語欄から日本語と英語を追加。右の他のコレクション欄から `LaTeX 推奨パッケージ' を追加。
        \end{itemize}
\end{itemize}
これが終われば右下のインストールをクリックする。

これをすれると一時間から一時間半程度でインストールすることができる。\footnote{これらのインストール時間は目安であり通常は回線の速さによって変化する。}

\subsection{インストールが正常に行われたことを確認する}
インストール完了後、コマンドプロンプトを起動して、\verb|latex -v|と打ち込む。
この時に、$3.141592653$のようなversion情報が出てこれば正常に完了している。
\footnote{
  これは、\TeX 製作者Donald E.Knuth教授\index{Donald E.Knuth}の意向で
  version up ごとに円周率$\pi$へ近づいて行く。
}

\section{Visual Stadio Code の導入}
\subsection{Visual Stadio Code のインストール}
Visual Studio Code は次のページからダウンロードするとよい。
\begin{quote}
  \url{https://code.visualstudio.com/download}
\end{quote}
をクリックしてそのあとの画面の中から今回の場合は、
自分の環境に合わせて (Windows か Mac の) ファイルをダウンロードする。
ファイルを開き、追加タスクの変更は触らないようにしてNextを押し続ければ
インストールできる。
\subsection{VS codeの日本語化}
VS Codeをショートカットから開いて、積み木のようなアイコンExtentions（拡張機能）\index{Extentions（拡張機能）}
をクリック。検索窓にJapaneseと打って、
Japanese Language Pack for Visual Studio Code
を選択してインストールする。これで日本語化が完了する。
このように拡張機能を入れることでVS Codeの機能をより使いやすいものにすることができる。

\section{latexmk\index{latexmk}の導入}
\subsection{latexmkとは}
\LaTeX 文書を手動でコンパイルしようとすると複数種類のコマンドを適切な順番で複数回実行しなければならない。latexmkとは、各種\LaTeX のビルドコマンドを自動で一括で実行してくれるツールである。

\subsection{latexmkのインストール}

TeXの導入で最小構成を選択した人は最初からlatexmkは入っていないのでTeX Live Managerからダウンロードする必要がある。

TeX Live Managerをスタート画面から検索して開く。TeX Live Managerを起動して待機中になったら、検索欄から`latexmk'と検索する。すると、しばし待機した後に二つの`latexmk'が出てくる。
\begin{itemize}
  \item latexmk
  \item latexmk.win32
\end{itemize}
の二つが出てくるので、これらをチェックボックスをクリックして選択項目をインストール を選択し latexmk を選択してインストールする。これでlatexmkのインストールが完了する。

今回の環境構築では\LuaLaTeX
を用いるのでlualatex-mathというパッケージをダウンロードする必要がある。
フルパッケージでTeX Liveをインストールした場合には入っている。また、TeX Live Managerですでに入っていると表示される場合は問題ない。
  \cite{TeXLiveトラブルシューティングlualatex}参照

\subsection{latexmkの設定}
ホームディレクトリ
\footnote{
  PC>ローカルディスク>ユーザー>ユーザー名、と辿れるディレクトリのこと
}
直下に\verb|.latexmkrc|というテキストファイルを作成し、テキストエディタで開く。
ここでテキストエディタはVS Code を使うこと。VS Code でUTF-8\index{UTF-8}
\footnote{UTF-8とはUnicode用の符号化方式の一つである。UTF-16もある。VS Codeではデフォルト設定としてUTF-8となっている。しかしほかのエディタ(例えばメモ帳等)ではデフォルトでUTF-8になっていない可能性がある。他エディタでlatexmkをつくり、VS Codeで開いた際にUTF-8以外のときにはステータスバーからUTF-8に直す必要がある。\cite{VSCodeの文字コード}}
にしなければならない。
markdownファイルに記載されたlatexmkの設定をコピーして貼り付け、保存する。
同じ内容をソースコード\ref{code:latexmk}に示す。

\begin{lstlisting}[caption=latexmkの設定,label=code:latexmk]
  # 通常の LaTeX ドキュメントのビルドコマンド
  $latex = 'uplatex %O -kanji=utf8 -no-guess-input-enc -synctex=1 -interaction=nonstopmode %S';
  # pdfLaTeX のビルドコマンド
  $pdflatex = 'pdflatex %O -synctex=1 -interaction=nonstopmode %S';
  # LuaLaTeX のビルドコマンド
  $lualatex = 'lualatex %O -synctex=1 -interaction=nonstopmode %S';
  # XeLaTeX のビルドコマンド
  $xelatex = 'xelatex %O -no-pdf -synctex=1 -shell-escape -interaction=nonstopmode %S';
  # Biber, BibTeX のビルドコマンド
  $biber = 'biber %O --bblencoding=utf8 -u -U --output_safechars %B';
  $bibtex = 'pbibtex %O %B';
  # makeindex のビルドコマンド
  $makeindex = 'upmendex %O -o %D %S';
  # dvipdf のビルドコマンド
  $dvipdf = 'dvipdfmx %O -o %D %S';
  # dvipd のビルドコマンド
  $dvips = 'dvips %O -z -f %S | convbkmk -u > %D';
  $ps2pdf = 'ps2pdf.exe %O %S %D';
  
  # PDF の作成方法を指定するオプション
  ## $pdf_mode = 0; PDF を作成しない。
  ## $pdf_mode = 1; $pdflatex を利用して PDF を作成。
  ## $pdf_mode = 2; $ps2pdf を利用して .ps ファイルから PDF を作成。
  ## pdf_mode = 3; $dvipdf を利用して .dvi ファイルから PDF を作成。
  ## $pdf_mode = 4; $lualatex を利用して .dvi ファイルから PDF を作成。
  ## $pdf_mode = 5; xdvipdfmx を利用して .xdv ファイルから PDF を作成。
  $pdf_mode = 4;
  
  # PDF viewer の設定
  if ($^O eq 'MSWin32') {
    $pdf_previewer = "start %S";  # "start %S": .pdf に関連付けられた既存のソフトウェアで表示する。
  } else {
    $pdf_previewer = "open %S";
  }
  
  ## Windows では SyncTeX(PDF をビューアーで開いたまま中身の更新が可能で更新がビューアーで反映される機能) が利用できる SumatraPDF 等が便利。
  ## ぜひ SyncTeX 機能のあるビューアーをインストールしよう。
  ## SumatraPDF: https://www.sumatrapdfreader.org/free-pdf-reader.html
  ## $pdf_previewer = 'SumatraPDF -reuse-instance';
  \end{lstlisting}
% jlistingsで設定ファイルを貼り付け
% つまりルートフォルダーにこのファイルを保存するということ。
% // ホームディレクトリは C:/Users/ユーザー名/
% // ルートディレクトリは C:/
% // のことを指し、両者は異なります。
\subsection{latexmkの設定の解説}
% wip

\section{LaTeX workshop\index{LaTeX workshop}の設定}
VS Codeの設定は、setting.json\index{setting.json}
\footnote{.jsonはジェイソンと読む}
というファイルに記載されている。
setting.json を開く方法はいくつかある。
\begin{description}
  \item[1つ目] ~\\
    VS Code左下の設定マーク（歯車マーク）をクリックして、「設定」を選択する。
    右上端にあるファイルに矢印がついたアイコンをクリックする。
  \item[2つ目] ~\\
    キーボードのショートカットキーを用いて、ctrl+shift+P と入力することで、
    コマンドパレットを出現させてそこにPreferences:Open User Setting
    と打ち込む。
    \item[3つ目]~\\
    Ctrl+ , で設定画面を開く。さらに右上端にあるファイルに矢印がついたアイコンをクリックする。
\end{description}
の2つの方法があり熟練したら2番目の方法の方が効率が良い。
% // そう頻繁に編集するものではないので、1つ目の方法でいいと思います。

% .json はJavaScript に対応している。
% // JavaScript に触れる必要はないのでは？
setting.json を開いたら、\verb|{}|の中にmarkdownファイルに記載されたLaTeX workshopの設定をコピーして書き加え、保存する。
同じ内容をソースコード\ref{code:latexworkshop}に示す。
% jlistingsで設定ファイルを貼り付け
% なお、platexの設定についてはすでに書き換えられたものを提示する
もし開いた時点で\verb|{}|以外に何か書き込まれていた場合、\verb|{}|の最後の要素にコンマをつけて、設定をコピーして書き加え、保存する。
\begin{lstlisting}[caption={LaTeX workshopの設定},label=code:latexworkshop]
  {
  //  LaTeXの設定
  "editor.wordSeparators": "./\\()\"'-:,.;<>~!@#$%^&*|+=[]{}`~?　、。「」【】『』（）！？てにをはがのともへでや",

  // 設定: LaTeX Workshop

  // LaTeX Workshop ではビルド設定を「Tool」と「Recipe」という2つで考える
  //   Tool: 実行される1つのコマンド。コマンド (command) と引数 (args) で構成される
  //   Recipe: Tool の組み合わわせを定義する。Tool の組み合わせ (tools) で構成される。
  //   tools の中で利用される Tool は "latex-workshop.latex.tools" で定義されている必要がある。
  
  // latex-workshop.latex.tools: Tool の定義
  "latex-workshop.latex.tools": [
    // latexmk を利用した lualatex によるビルドコマンド
    {
      "name": "Latexmk (LuaLaTeX)",
      "command": "latexmk",
      "args": [
        "-f", "-gg", "-lualatex", "-synctex=1", "-interaction=nonstopmode", "-file-line-error", "%DOC%"
      ]
    },
    // latexmk を利用した xelatex によるビルドコマンド
    {
      "name": "Latexmk (XeLaTeX)",
      "command": "latexmk",
      "args": [
        "-f", "-gg", "-xelatex", "-synctex=1", "-interaction=nonstopmode", "-file-line-error", "%DOC%"
      ]
    },
    // latexmk を利用した uplatex によるビルドコマンド
    {
      "name": "Latexmk (upLaTeX)",
      "command": "latexmk",
      "args": [
        "-f", "-gg", "-synctex=1", "-interaction=nonstopmode", "-file-line-error", "%DOC%"
      ]
    },
    // latexmk を利用した platex によるビルドコマンド
    // 古い LaTeX のテンプレートを使いまわしている (ドキュメントクラスが jreport や jsreport ) 場合のため
    {
      "name": "Latexmk (pLaTeX)",
      "command": "latexmk",
      "args": [
        "-f", "-gg", "-pv", "-latex='platex'", "-latexoption='-kanji=utf8 -no-guess-input-env'", "-synctex=1", "-interaction=nonstopmode", "-file-line-error", "%DOC%"
      ]
    },

    {
      "name": "pLaTeX",
      "command": "platex",
      "args": [
        "%DOC%","-file-line-error","-interaction=nonstopmode","-halt-on-error"
      ],
      "env": {}
    },
    {
      "name": "dvipdfmx",
      "command": "dvipdfmx",
      "args": [
        "-V 4",
        "%DOC%"
      ]
    },
    {
      "name": "Biber",
      "command": "biber",
      "args": [
        "%DOCFILE%"
      ]
    },
],

  // latex-workshop.latex.recipes: Recipe の定義
"latex-workshop.latex.recipes": [
      // LuaLaTeX で書かれた文書のビルドレシピ
      {
        "name": "LuaLaTeX",
        "tools": [
          "Latexmk (LuaLaTeX)"
        ]
      },
      // XeLaTeX で書かれた文書のビルドレシピ
      {
        
        "name": "XeLaTeX",
        "tools": [
          "Latexmk (XeLaTeX)"
        ]
      },
      // LaTeX(upLaTeX) で書かれた文書のビルドレシピ
      {
        "name": "upLaTeX",
        "tools": [
          "Latexmk (upLaTeX)"
        ]
      },
      // LaTeX(pLaTeX) で書かれた文書のビルドレシピ
      {
        "name": "pLaTeX + dvipdfmx",
        "tools": [
          "pLaTeX", // 相互参照のために2回コンパイルする
          "pLaTeX",
          "dvipdfmx"
        ]
      },
      {
        "name": "pLaTeX + Biber + dvipdfmx",
        "tools": [
          "pLaTeX",
          "Biber",
          "pLaTeX",
          "pLaTeX",
          "dvipdfmx"
        ]
      },
  ],

  // latex-workshop.latex.magic.args: マジックコメント付きの LaTeX ドキュメントをビルドする設定
  // '%!TEX' で始まる行はマジックコメントと呼ばれ、LaTeX のビルド時にビルドプログラムに解釈され、
  // プログラムの挙動を制御する事ができる。
  // 参考リンク: https://blog.miz-ar.info/2016/11/magic-comments-in-tex/
  "latex-workshop.latex.magic.args": [
    "-f", "-gg", "-pv", "-synctex=1", "-interaction=nonstopmode", "-file-line-error", "%DOC%"
  ],

  // latex-workshop.latex.clean.fileTypes: クリーンアップ時に削除されるファイルの拡張子
  // LaTeX 文書はビルド時に一時ファイルとしていくつかのファイルを生成するが、最終的に必要となるのは
  // PDF ファイルのみである場合などが多い。また、LaTeX のビルド時に失敗した場合、失敗時に生成された
  // 一時ファイルの影響で、修正後のビルドに失敗してしまう事がよくある。そのため、一時的なファイルを
  // 削除する機能 (クリーンアップ) が LaTeX Workshop には備わっている。
  "latex-workshop.latex.clean.fileTypes": [
      "*.aux", "*.bbl", "*.blg", "*.idx", "*.ind", "*.lof", "*.lot", "*.out", "*.toc",
       "*.acn", "*.acr", "*.alg", "*.glg", "*.glo", "*.gls", "*.ist", "*.fls", "*.log",
        "*.fdb_latexmk", 
      // for Beamer files
      "_minted*", "*.nav", "*.snm", "*.vrb",
  ],

  // latex-workshop.latex.autoClean.run: ビルド失敗時に一時ファイルのクリーンアップを行うかどうか
  // 上記説明にもあったように、ビルド失敗時に生成された一時ファイルが悪影響を及ぼす事があるため、自動で
  // クリーンアップがかかるようにしておく。

  "latex-workshop.latex.autoClean.run": "onBuilt",

  // latex-workshop.view.pdf.viewer: PDF ビューアの開き方
  // VSCode 自体には PDF ファイルを閲覧する機能が備わっていないが、
  // LaTeX Workshop にはその機能が備わっている。
  // "tab" オプションを指定すると、今開いているエディタを左右に分割し、右側に生成されたPDFを表示するようにしてくれる
  // この PDF ビュアーは LaTeX のビルドによって更新されると同期して内容を更新してくれる。
  "latex-workshop.view.pdf.viewer": "tab",

  // latex-workshop.latex.autoBuild.run: .tex ファイルの保存時に自動的にビルドを行うかどうか
  // LaTeX ファイルは .tex ファイルを変更後にビルドしないと、PDF ファイル上に変更結果が反映されないため、
  // .tex ファイルの保存と同時に自動的にビルドを実行する設定があるが、文書が大きくなるに連れてビルドにも
  // 時間がかかってしまい、ビルドプログラムの負荷がエディタに影響するため、無効化しておく。
  "latex-workshop.latex.autoBuild.run": "never",

  "[tex]": {
      // スニペット補完中にも補完を使えるようにする
      "editor.suggest.snippetsPreventQuickSuggestions": false,
      // インデント幅を2にする
      "editor.tabSize": 2
  },

  "[latex]": {
      // スニペット補完中にも補完を使えるようにする
      "editor.suggest.snippetsPreventQuickSuggestions": false,
      // インデント幅を2にする
      "editor.tabSize": 2
      
  }, 


  "[bibtex]": {
      // インデント幅を2にする
      "editor.tabSize": 2
  },
  


  // ---------- LaTeX Workshop ----------

  // 使用パッケージのコマンドや環境の補完を有効にする
  "latex-workshop.intellisense.package.enabled": true,
  "window.zoomLevel": -1,
  "catex.greek-completion": {
  
    "name": "CaTeX Greek Completion",
    "languages": [
      "latex"
    ],
    "triggers": [
      ":"
    ],
    "dictionary": "$GIM/defaults/greeks.json",
    "renderMode": "latex"
  },

  // 、を,に変えることができる設定latexindent.yamlを用いて設定。

}  
\end{lstlisting}
% \subsection*{LaTeX workshopの設定の説明}

% \subsection{\pLaTeX のコンパイルについて}
% \pLaTeX のコンパイルについて
% \pLaTeX に関する設定だけは、うまくいかないので下のように書き換える。
% \pLaTeX  のところの
% recipe tools の変更をおこなう。
% setting.jsonのlatex-workshop.latex.toolsのところに次のように書き換える。


% どこを指しているか分かりませんでした...

\subsection{自動ビルド機能の設定\index{じどうびるどきのう@自動ビルド機能}}
\begin{verbatim}
	"files.autoSave": "afterDelay", 
  "latex-workshop.latex.autoBuild.run": "never",
\end{verbatim}
% autoSaveも含めた解説にする
は、自動ビルド機能である。しかし、自動ビルドは、
このファイルのように大きすぎると非常に重くなってしまう。
\LaTeX は、コンパイルと、書くことを分離することで、
高度なレイアウトの最適化を可能にしている。
% 書く必要量をへらしているために
これはneverにしておくことをオススメする。
% 自動保存機能とともに紹介すると納得しやすいかもしれない。

\section{ローカル環境でビルドする}
ここまでの内容が行えていれば、十分に高機能な環境構築ができているはずである。
ローカル環境でビルドできることを確認してみよう。
ソースコード\ref{code:helloWorld}の内容の.texファイルを作成し、VScode上でビルドする。
% jvlistingでコードを貼り付ける
\begin{lstlisting}[caption={\LuaLaTeX のソースコード},label=code:helloWorld]
\documentclass{ltjsarticle}
% ltjsarticle: lualatex 用の 日本語 documentclass
% LuaLaTeX以外のタイプセットエンジンを使ってビルドする場合は、 \documentclass[dvipdfmx]{jsarticle} などのように適当に書き換える。

\begin{document}

\title{はじめての\LaTeX }
\author{Meidai}
\maketitle
\section{はじめての\LaTeX Lua\LaTeX }
%\section{はじめての\LaTeX Lua\TeX}


\subsection{小見出し！}
Hello world!
今日は\LaTeX を覚えていってください。
\LaTeX + VSCode は最強の組み合わせ。

\end{document}  
\end{lstlisting}

\part{\LaTeX 解説}
\section{TeX live}
\subsection{TeX live とは？}
TeX liveとは、TeX の国際的なディストリビューションである。
\LaTeX や\TeX のパッケージを入手することができる。

そして、\LaTeX のパッケージを一括で管理することができる機能がTeX Liveに標準で実装されているTeX Live Manager\index{TeX Live Manager}である。
\subsection{TeX live Manager の使い方}
TeX Live ManagerはスタートメニューからTeX live Managerと検索すると開くことができる。

TeX live Managerを開くと現在TeX liveのパッケージのうちでローカルにインストール済みのものが表示される。
状態を「未インストール」に変更すると、
自分がローカルにインストールしていないパッケージが表示される。
検索欄で必要なパッケージを検索して選択、「選択項目をインストール」と操作することでインストールができる。

\LaTeX 導入の段階で「高度な設定」を用いてインストールした場合には
必要最小限のパッケージしかインストールされていないのでここからインストール必要がある。


\section{\LaTeX の基本機能}
\LaTeX の特徴の一つに文書の論理的構造と視覚的なレイアウトを分けて考えることができることがある。
例えば、「はじめに」という名前の節があれば文書に\verb|\section{はじめに}|と書いておく。
この文書をコンパイルするに際し、
\verb|\section{...}|という命令がどのような見た目になるかはスタイルファイルに記述されており、それを元に目的のファイルが生成される。
\LaTeX はこのような構成をしているため文章を書くときはデザインのことを考えずに済むし、デザインを変えたいときはスタイルファイルを変更するだけで済むのである。

我々が\LaTeX で文書を作る時には、この利点を最大限に享受するため、
直接見た目を指示するような命令はなるべく使わないようにするべきだろう。

% \LaTeX の基本精神は、人間は、内容に集中して \LaTeX はデザインに
% 集中するという使い方をすること。余計な装飾はできるだけ避けるのが無難。

\subsection{コンパイル}
\begin{itemize}
  \item ctrl+Alt+Bのショートカットキーでおこなう。
  \item VS Code右上の緑色の三角マークをクリックして行う。
  \item 左のタブのBuild LaTeX project の中のRecipe:からおこなう。
\end{itemize}
ただし、今回の設定では、上の2つの方法でコンパイルすると\LuaLaTeX
で出力される。このために、\pLaTeX などを使いたい場合は、
左のタブからおこなう必要がある。

% \section{\LaTeX のモダンな書き方}
% \LuaLaTeX におけるモダンな書き方を書きたい。例えば使用すべきpackageや他のものの注意等

\section{エラーの解決方法}
\LaTeX で文書を執筆する上で、数々のエラーに遭遇することになるだろう。
赤い文字に怒られたように感じるかもしれないが、それは勘違いである。
エラーメッセージは、修正するヒントを与えてくれている心強い味方であることを忘れてはならない。

エラーが起きた時の典型的な解決手順を順番に解説する。
\subsection{エラーメッセージの表示方法}
VSCodeでのビルド時にエラーが起きた場合、一度VScode はビルドを再試行する。この際右下に
Recipe terminated with error. Retry building the project.
というポップアップが表示される。
2回目のビルドでもエラーが起きた場合、
Recipe terminated with error.
というポップアップが表示される。
まずはOpen compiler logボタンをクリックしてエラーメッセージを表示しよう。

\subsection{原因の切り分け}
エラーメッセージが出ていることを確認したら、エラーが出ていそうな部分をコメントアウトしてからビルドするなどして、
エラーが出ていない部分を確定させる。
こうすることで、見当違いの場所に修正を施してしまうといった事態を避けることができる。

\subsection{エラーメッセージの読み方}
原因となる部分が分かったら、エラーメッセージを読む。
エラーメッセージの中に
\begin{lstlisting}
c:/<path>:xxx: Undefined control sequence.
l.xxx ...<エラー直前のソース>
                               <エラー位置のソース
\end{lstlisting}
というような内容が書かれた部分があるはずだ。
そのうち一番最初に出てくるものの解決にとりかかろう。

まずはエラーの種類をよく読もう。英語だからと読み飛ばしてはいけない。
エラーメッセージにはエラーが起こった個所と原因が書いてある。
この場合はxxx行目でUndefined control sequence, すなわち未定義のコマンドが使われたことが原因のようだ。
原因となったコマンドをを適切なコマンドに置き換えることでエラーは解決するだろう。

原因からすぐに解決方法が分かる場合は、その方法を実行しよう。
そうでない場合はエラーメッセージをそのままコピーして検索すると、大体は偉大な先人が残してくれた解決策が見つかる。

\subsection{よくあるエラー}
\subsubsection*{Undefined control sequence.}
コントロールシークエンス、つまりコマンドが定義されていないというエラーである。
コマンドのスペルミス、あるいはコマンドの後のスペースの入れ忘れを疑うべきである。

\subsubsection*{Paragraph ended before \textbackslash align was complete.}
align環境は空行を入れるとエラーが起きる。

\subsubsection*{File ended while scanning use of \textbackslash @xdblarg.}
\verb|\@xdblarg| の内容を読んでいる間にファイルが終わってしまったという趣旨のエラーである。
解決方法の推測が難しいが、かっこの閉じ忘れでこのエラーが起きる。

\subsection{それでも解決しなかったら}
\LaTeX の基本的な機能を使っているうちは大抵は上の方法で解決する。
もしそれでも解決しない場合は、マニュアルを参照することを検討しよう。

特にパッケージの使い方に関してはマニュアルが一番信頼できる情報源である。
\subsubsection{\LaTeX のマニュアル}
\verb|texdoc| \index{texdoc} はTeXLiveに含まれるドキュメントを検索できるコマンドである。
例えばtexdocについて調べたい場合は、ターミナルで\verb|texdoc texdoc|と実行するとtexdoc の使い方が書かれたpdfファイルが開く。

%そもそもLaTeXは最近のソフトウェアのような洗練されたエラーメッセージを出力しないため、それを前提とした VS Code のエラーハンドリング機能との相性は良くない。
% エラーポップアップやコンソールの問題タブなどを見るよりも、エラーメッセージ全文から探したほうが効率がよいと思われるため、個人的には出力タブをスクロールして確認することをおすすめしたい。
% c:/<path>:xxx: Undefined control sequence.
% l.xxx ...<エラー直前のソース>
%                                <エラー位置のソース
% みたいな感じの部分を探し、エラーメッセージの部分(この場合"Undefined control sequence.")をググると、大体は偉大な先人が残してくれた解決策が見つかる。

\section{新規packageの導入}
新規パッケージ\index{パッケージ}つまり、インターネット上や、
自分で作ったスタイルファイル\index{スタイルファイル}等を使いたいときに、めんどくさいことになる。
パッケージファイルの拡張子は``.sty''であり、
このパッケージを適切な場所に配置しなければならない。
しかし、``.sty''が入っていない場合がある。これに対処するためには次セクション

\subsection{``.sty''ファイルが入っていない場合}
``.ins''ファイルが重要になる。
このファイル形式は、パッケージ本体と``.ins''ファイルが入っている.dtxを
\LaTeX で.dtx ファイルを実行する必要がある。\\
たとえばtools.ins というファイルがあった場合には、.dtx ファイルを
同じディレクトリに保存する。次に
コマンドプロンプトを起動して、以下のように、入力する。
\begin{verbatim}
  latex tools.ins
\end{verbatim}
すると、同じフォルダー内に.sty ファイルが生成される。
この.styファイルの保存場所は、次セクション参照。

\subsection{TeX Directory Structure\index{TeX Directory Structure} とは何か？}
\LaTeX のパッケージなどは、TDS（TeX Directory Structure）\index{TDS（TeX Directory Structure）}にしたがって各
ディレクトリに配置されている。
今回はTeX Liveなので、エクスプローラーからwindowsフォルダーの中の
texlive フォルダーの中の2022年フォルダーの中のtexmf-distの中のtexの中の
latexフォルダーの中に各パッケージのフォルダーがあり、
その中に各スタイルファイルフォルダーが保存されている。といった構成に
なっている。
これは非常に見にくいし、読みにくいので、ここからは、これを
\begin{verbatim}
  C:\texlive\2022\texmf-dist\tex\latex
\end{verbatim}
のように書くと簡便になる。
そしてこれがWindowsのディレクトリの記述の仕方である。
この中のtexフォルダーにはたくさんのフォルダーがあるが、
最初に覚えておくべきは2つで、
\begin{center}
  \begin{tabular}{ll}
    \hline
    folder名 & 意味                               \\
    \hline
    tex     & TeXの操作に関するフォルダーで、latex フォルダーがある。 \\
    font    & フォントにかかわるフォルダー。                  \\
    \hline
  \end{tabular}
\end{center}
であり、このことから、.styファイルの保存場所は、
\begin{verbatim}
  C:\texlive\2022\texmf-dist\tex\latex
\end{verbatim}
よりも下のファイルに加えれば良いことがわかった。
フォントファイルについては、以下参照。
\url{https://texwiki.texjp.org/?TeX%20%E3%81%AE%E3%83%87%E3%82%A3%E3%83%AC%E3%82%AF%E3%83%88%E3%83%AA%E6%A7%8B%E6%88%90}

\subsection{パッケージを使うための一覧表の更新}
TeX Live環境では、上のように.styファイルを保存しても動かない。これは、
ls-Rというファイルが存在していてこれが、TeXが必要なパッケージを探すための
パスを与えている。そのために、この一覧表を更新しなければならない。
このためには、コマンドプロンプトを開き、次のように命令するだけでいい。
\begin{verbatim}
  mktexlsr
\end{verbatim}
\index{mktexlsr}
と入力することで一覧表を更新することができる。

\subsection{使用するべきpackage}
packageは最小構成でおこなうべきである。
なぜなら、\LuaLaTeX はかなり最近のものであり、packageが\LuaLaTeX に
対応していないということもかなりの可能性としてある。
そのため、参考になるのは参考文献のサイト\cite{TDS}
になる。
% \section{TeX Live の更新について}
% tlmgr についてできたら追記


\part{VS Code 解説}
\section{VS Codeの基本機能}
デフォルトで使えるVS Codeの基本機能を解説する。

\subsection{検索/置換機能}\index{ちかんきのう@置換機能}
VS Codeの基本機能として、置換機能がついている。このためマクロを組まずとも
、を, に変えることができる。
コマンドは、Ctrl+Hキーを押すと検索と置換が出てきて、Enter キーを押すと
ひとつづつ置換、Crl+Alt+Enter キーを押すとすべてが置換される。
また置換を閉じるのはEsc キーである。

またctrl+shift+Fを押すことで検索サイドバーを開くことができる。


\subsection{コメントアウト機能}\index{コメントアウト機能}
\LaTeX は\verb|%|から行末までをコメントと認識する。しかしこれをいちいち書くのは面倒くさい。
さらにプログラム言語によりコメント機能はまったく違う。この時に、Ctrl+/ を
使うことで、その時に編集しているプログラム言語に応じて適切な構文でコメントアウトすることができる。

\subsection{各種ショートカット}
\begin{center}
  \begin{tabular}{ll}
    \hline
    ショートカットキー                        & 機能                 \\
    \hline
    Ctrl+Alt+B                       & ビルドを実行する           \\
    Ctrl+Alt+V                       & pdfviewer を起動する    \\
    Ctrl+click                       & SyncTeXの利用（pdf側）   \\
    Ctrl+Alt+J                       & SyncTeXの利用（コード側）   \\
    Ctrl+Hキー                         & 置換パレットの表示          \\
    Crl+Alt+Enter                    & 置換の全置換             \\
    Ctrl+/                           & 行のコメントアウト機能（全言語共通） \\
    Ctrl+@                           & VS Codeのターミナルの起動   \\
    Shift+Alt+F                      & latexindentを実行する   \\
    Ctrl+Space                       & コード補完を再表示          \\
    Ctrl+Shift+ \verb|+| or \verb|-| & ズームの程度を調整する        \\
    \hline
  \end{tabular}
\end{center}
ただし、ショートカットキーによってビルドした場合は、
Build LaTeX projectの最初に記述されているコマンドをビルドコマンドとして呼び出す。
これらのショートカットキーはデフォルトで設定されているもので、好きなキーに変更することもできる。

\subsection{pdf viewerについて}
VSCodeにはpdfvewerが入っている。この機能について解説する。
\LaTeX で生成した文章は外部のviewer（例えばedgeやchromeなど）でも見ることができる。しかし、VSCodeではSynicTeXや検索機能等も使うことができる。

\begin{description}
  \item[検索機能]  文書内の文字列を検索することができる。Ctrl+F を押すことで文章内の検索をかけることができる。
  \item[PDFの目次を見る] PDFの目次を見ることができる。この目次はbookmarkパッケージを用いたときまたはそのpdfがそもそもブックマークがついていた時に限るが目次から簡単に飛ぶことができる。これは、pdfviewerの上のタスクバーの一番左のアイコンをクリックすることで見ることができる。
\end{description}



\section{VS Codeの設定について}
\subsection{VS Code の設定について}
VS Codeの設定は、setting.jsonというすべてに適応される設定と、workspace設定という、workspaceと呼ばれるファイルを何個か入れた空間について設定ができる。さらにファイルごとにも設定ができる。この優先順位は、setting.json 、work space 設定、ファイル設定の順に高い。これの設定のおかげで、さまざまな設定がおこなえるようになる。ワークスペースが1つのアプリケーションのように使うことができる。
% ユーザー設定もワークスペース設定も(ディレクトリの異なる)setting.jsonに設定を記述するため、ユーザー設定をsetting.jsonと呼ぶのは誤解の恐れがあります。
% ワークスペースの説明が必要です。

\subsection{wordwrap\index{wordwrap}}
wordwrapとは、このエディターの中で入力している中でpdfview等にしているときに文章が見えている間で改行を自動で行ってくれる設定である。この設定は最初、自動改行しない設定になっている。この時には、書いている行が右にシフトしてしまい、マウス又は、エンドキー等で次の行にしなければならない。また見るときも水平スクロールをしなければならない。しかしこの機能を有効にすることで、自動で改行し、文章の視認性が高くなる。
% プログラミングするときも、onにしておくことをおすすめしたい。


\subsection{スニペット}
\subsubsection*{スニペットと自動補完}


VSCodeには引数や入力を補完するシステムがある。これを自動補完\index{自動補完@じどうほかん}という。
\footnote{VSCode等のmicrosoft製品ではこの自動補完のことを固有の機能名でインテリセンス\index{インテリセンス}と呼ぶ。Microsoft製品の公式ドキュメント等はインテリセンスと読んでいる。この資料ではより一般的な自動補完ということにする。}
これは、VSCodeの基本的な機能の一つである。これは特に設定の必要はない。入力者はサジェスト\footnote{サジェスト\index{サジェスト}は``suggest''に由来し、予測変換の意味がある。}に表示された提案の中から、Tabキーやspaceキーで補完することができる。

スニペットは非常に長いコードをも格納することができ非常に短いコードでそのコードを呼び出すことができる点で有用である。

スニペット\index{スニペット}とは、コードの中で何回も使うだろうコードを少しの記述
でそれを呼び出す一連の動作のことをいう。スニペットの語源は、
短い単語のことである。


\subsubsection{ユーザースニペットの導入}
まずスニペットを導入する。左下の歯車から「ユーザースニペットの構成」を
選択する。検索窓が出てくるので、latexと入力して latex.json を開く。
latex.json にも、\verb|{}|があるので、その中に次のコードをコピーする。

% 参照すべきコードが示されていません
\begin{lstlisting}
  {
    "report":{
        "prefix": "report",
        "body": [
            "\\documentclass[a4paper,11pt]{ltjsarticle}",
            "",
            "",
            "% 数式",
            "\\usepackage{amsmath,amsfonts}",
            "\\usepackage{bm}",
            "% 画像",
            "\\usepackage{graphics}",
            "\\usepackage{graphicx}",
            "\\usepackage{here} %画像の表示位置調整用",
            "\\usepackage{type1cm}",

            "",
            "%A4: 21.0 x 29.7cm",
            "${4}",
            "",
            "\\begin{document}",
            "",
            "\\title{${5}}",
            "\\author{${6}}",
            "\\date{${7:\\today}}",
            "\\maketitle",
            "",
            "",
            "$0",
            "",
            "",
            "\\end{document}"
        ],
        "description": "授業レポート用テンプレート"
    }
  }
  \end{lstlisting}

と書く。たとえば、report とlatexで打つと、
reportのひな形が出てくるようになる。
このように、スニペットはプリアンブル部等
を簡単に早く書くことができるようになる。

\subsection{スニペットの書き方}
ユーザースニペットのフォーマットは次のように書く。
スニペットもsetting.jsonと同じように、','で各設定を区切る。
\begin{lstlisting}[caption=latex.json]

	{
  "[ スニペットの名前 ]": {
    "prefix": "[ 呼び出すときのショートカット]",
    "body":[
      "[ 出力されるコードの1行目]",
      "[ 出力されるコードの2行目]",
      "...",
    ],
    "description": "[ スニペットの説明文]"
  }
  }

\end{lstlisting}
のように書く。
\subsubsection*{入力値の補足}
入力値の中のコマンドに\verb|$n|というのがあるがこれは、スニペットを
記述するときに入力するためのカーソルが
次にどこにいけば良いかを入力するための引数である。
たとえば、次の例では、プログラムを載せるための環境をスニペットにより
定義している。
% 例が前と同じなので、別の例を書き忘れていませんか

\begin{lstlisting}
  {
    "report":{
        "prefix": "report",
        "body": [
            "\\documentclass[a4paper,11pt]{ltjsarticle}",
            "",
            "",
            "% 数式",
            "\\usepackage{amsmath,amsfonts}",
            "\\usepackage{bm}",
            "% 画像",
            "\\usepackage{graphics}",
            "\\usepackage{graphicx}",
            "\\usepackage{here} %画像の表示位置調整用",
            "\\usepackage{type1cm}",

            "",
            "%A4: 21.0 x 29.7cm",
            "${4}",
            "",
            "\\begin{document}",
            "",
            "\\title{${5}}",
            "\\author{${6}}",
            "\\date{${7:\\today}}",
            "\\maketitle",
            "",
            "",
            "$0",
            "",
            "",
            "\\end{document}"
        ],
        "description": "授業レポート用テンプレート"
    }
  }
  \end{lstlisting}

このように書いたときに、カーソルが\verb|$1|を記述した後にTabキーを押すと
\verb|$2|にカーソルが移動するように書くことができる。
また、さらに、
\verb|$1|
が2つあるが
、これらは同じことを記述したい場合には
たとえば参照をタイトルと同じにしたい場合、
両方一度に入力することができる。
さらに、bodyの末尾に
\verb|$0|を入れておけば、入力終了後に
次の行からすぐに書き始めることができる。

ユーザースニペットに関して必要な注意また他の言語への応用等は\cite{スニペット1}\cite{スニペット2}\cite{スニペット完全解説}参照するとよい。

\subsection{禅モード\index{ぜんもーど@禅モード}}
禅モードはCtrl+K Z  を用いると使うことができるモードでこのモードでは下のステータスバー等がなくなりコーディング作業に集中できるモードになっている。この禅モードから抜け出すためにはEscキーを押すことで抜け出すことができる。
ここでは、ショートカットキーを使うことでさまざまな操作をすることができる。
そのためにコーディング作業をするときにこのモードを使うと集中することができる。

% 禅モードに関する解説。
\part{VS Code 外部ツール}
\section{LaTeX workshop}
\subsection{snippet View\index{snippet View}}
LaTeX Workshop から提供されているスニペットには一覧パネルがある。この一覧パネルはよく使う数学記号についてのスニペットに対応している。アクティビティバーのTeXのパネルから使うことがあるのである。これはGUIで使うことができるのでLaTeXでWhat you see is what you get \index{What you see is what you get}が可能になる。
このバーはドラッグすることでコントロールパネルや、Secondary Side Barに移動することができる。
\subsection{文字数カウント}
文字数をカウントするにはいくつかの方法がある。
\begin{description}
  \item[方法１]Ctrl+A を用いてすべて選択して下のステータスバーを見ると 何個選択という表示が現れる。
  \begin{description}
    \item[利点]~
    \begin{itemize}
      \item 拡張機能無しで文字数を数えることができる
      \item どの拡張子でも使える。
    \end{itemize}
    \item[欠点]~
    \begin{itemize}
      \item ステータスバーに常に表示されていないこと。
      \item 文字数とは関係のないところもカウントされること。例えばプリアンブルなど
    \end{itemize}
  \end{description}

  \item[方法２]ltexworkshopの設定を用いる。コマンドパネルを開いて、 ``latex-workshop.texcount''のコマンドを用いる。
  \begin{description}
    \item[欠点]~
    \begin{itemize}
      \item ステータスバーに常に表示されていないこと。
      \item 毎回打つのは面倒くさい
    \end{itemize}
  \end{description}
  \item[方法３]  設定に書き込む方法
    setting.jsonに次を\verb|{}|のなかに書き込む
    \begin{lstlisting}[caption={wordCount}]
    // LaTeX-workshopの設定で文字数をカウントする。
    "latex-workshop.texcount.autorun": "onSave",
    // LaTeX-Workshopの設定で文字数をカウントのタイミングを調整する。
    "latex-workshop.texcount.interval": 1000,
  \end{lstlisting}
    \begin{description}
      \item[利点]~
      \begin{itemize}
        \item ステータスバーに表示され楽
        \item 毎回打つ手間がない
      \end{itemize}
      \item[欠点]~
      \begin{itemize}
        \item tex以外の拡張子では使えない。
      \end{itemize}
    \end{description}
  \item[WordCounterを用いる方法]
    \begin{description}
      \item[利点] ~
        \begin{itemize}
          \item どの拡張子でも使える。
          \item 読了時間などのカスタムができる。
        \end{itemize}
        \item[欠点]~
        \begin{itemize}
          \item TeXのコマンドまで認識してしまう。
          \item ステータスバーが窮屈になる。
        \end{itemize}
    \end{description}
    ことが挙げられる。
\end{description}

\subsection{SyncTexを使う}
\subsubsection*{SyncTex とは何か？\index{SyncTex}}
TeX のソースファイルと PDF でカーソルの位置を同期する機能のこと。
これを使えば、pdf上の表示がどのソースに関係しているかということが
すぐにわかる。

\subsubsection*{SyncTeXの設定}
SyncTeXは、ビルドするときに形成されるファイル
\verb'*.synctex.gz'を使って動作する。

コマンドラインでSyncTeXを使う場合にはコマンドで
\begin{lstlisting}[caption=synctex,label=synctex]
  -synctex
\end{lstlisting}
をつけることで.synctexのファイルを生成することができる。

また、
\begin{lstlisting}[caption=synctex=1,label=synctex=1]
  -synctex=1
\end{lstlisting}
のオプションをつけた場合には、.synctex.gzという形式の圧縮ファイルが生成される。
\begin{lstlisting}[caption=synctex=-1,label=synctex=-1]
  -synctex=-1
\end{lstlisting} 
の場合には、.synctexという形式のファイルが生成される。

LaTeXworkshopでのコンパイルの際には、
\begin{lstlisting}[caption=SyncTeX,label=SyncTeX]
  "args": ["-synctex=1"]
\end{lstlisting}
のように追記することで、SyncTeXファイルを生成することができる。

また、このファイルを消さないためには、
\begin{verbatim}
  "latex-workshop.latex.clean.fileTypes":
\end{verbatim}
の記述の中から、
\begin{verbatim}
  "*.synctex.gz"、
\end{verbatim}
の記述を消去すればよい。
最初から無ければ問題ない。
これにより、VS Codeのpdfvierにおいて、
SyncTeXが利用できるようになる。

\subsubsection*{SyncTeXの具体的な利用の仕方}
pdfviewer上でCtrl キーを押しながらマウスでコードをみたい場所におき、
左クリックすることでそのコードの位置に飛ぶことができる。
逆にコードからpdfに飛びたいときは、選択範囲をマウスで示して、または
カーソルをおいて、 Ctrl+Alt+J で飛ぶことができる。
（コマンドパレットからSyncTeXと入れてコマンドを実行させてもよい。）

\subsection{シンタックスハイライト\index{シンタックスハイライト}}
シンタックスハイライトとは、\LaTeX の文章などを編集するためのコマンドに色を
つけることでその対応やコードの可読性を高めることができるVS Codeの機能である。
しかしながら、LaTeX workshopはそれに対応しているのだが
VS CodeのカラーテーマをVisual Studio Dark\index{Visual Studio Dark} または Visual Studio Light\index{Visual Studio Light}
にしているとうまく機能してくれない。したがってダークテーマで
シンタックスハイライトを使いたい場合は、デフォルト設定の
Dark+ \index{Dark+}を使用するとよい。又はほかのカラーテーマならば良い。

\subsection{cloud LaTeX との連携\index{cloud LaTeX}}
cloud LaTeX を使うことでパソコン内部に\LaTeX 環境を構築しなくとも
\LaTeX を使うことができる。cloud  LaTeX は cloud LaTeX と同一のサーバー内とローカルのこのVS Codeと連携することが可能であり、それにより、ローカルとサーバーで同期ができるために非常に便利なものとなっている。

\subsubsection*{利点}
\begin{itemize}
  \item データがサーバ上で保存するためにデータが消える心配はない。
  \item コンパイルがサーバ上でおこなわれるために自分のパソコンに負荷がかからないそのために自分のパソコンではできないautobuild が可能。
  \item cloud LaTeXのシステムやインストールされたパッケージを簡単に使うことができる。
\end{itemize}

\subsubsection*{欠点}
\begin{itemize}
  \item VS Code からサーバーを立ち上げることができないために、最初にcloud LaTeX の方に入る必要がある。
  \item 定期的な対応の更新をしなければならない。
  \item ローカル上ではコンパイルできないためにオフライン状態でコンパイルできない。
\end{itemize}
等が挙げられる。

\subsubsection*{cloud LaTeX との連携をするための設定}
導入の設定は、md形式のファイルに添付されているものをsetting.jsonに入れればよい。cloud LaTeX 参照
\subsection{LaTeXWorkshopの設定に困ったら}
LaTeXworkshopの設定に困った場合には、\cite{latexworkshopwiki}又は、公式ドキュメントである\cite{LaTeXworkshop_README}を読むとよい。しかしながらこれらは英語であるのでこれがいやな場合は、\cite{LaTeXworkshop1}\cite{LaTeXWorkshop2}\cite{LaTeXWorkshop3}\cite{LaTeXWorkshop4}\cite{数式プレビュー}
が公式ドキュメントを日本語に訳したような書き方をしているためにこれを読むとよい。\cite{LaTeX+VSCodewiki}等はVS Codeとlatexについて解説している数少ないwikiのページである。\cite{エラーをしながら1}\cite{エラーをしながら2}\cite{エラーをしながら3}は変わった方法で\LaTeX をVSCodeに導入している。またVSCodeの解説については、\cite{VSCodeの公式ドキュメント}\cite{VSCode完全入門}\cite{SyncTeXVSCode}等を参考にすると良い。

\section{cloudlatex}
\subsection{cloudlatexとは何か？}
cloudlatexとは、株式会社アカリクが運営している\LaTeX のビルドをリモート環境で行うサービスのことである。このcloudlatexを用いるとローカル環境に\LaTeX がインストールされていなくとも\LaTeX 文章を書くことができる。
\subsection{cloudlatexのVS Codeでの拡張機能}
\subsubsection{設定方法}
\LaTeX のコードを自前の環境で書き、コンパイルをリモート環境で行うことができる。
まずVSCode 上の拡張機能からcloudlatex の拡張機能をインストールする。次に自分のcloudlatexのマイページから右上のユーザー名をクリックしてプルダウンを開き「プラグイン連携」をクリックする。プラグイン\index{プラグイン}とは、拡張機能のことである。次にそこで生成されるトークンを二つコピーする。
「client」「access-token」の2つがわかっていればOKである。
次にVSCode上でCLと書いたアイコンが生成されるためにそこをクリックして「Set account」をクリックする。
「メールアドレス」「client」「access-token」を順番に入力する。「Your account has been validated!」という通知が出れば連携の設定は完了する。
\subsubsection{使い方}
使い方はCloud Latexで作成したプロジェクトをVisual Studio Codeで編集することができる。ここでまず初めにProject IDを取得する必要がある。URLを確認する

「https://cloudlatex.io/projects/XXXXXX/edit」となっている6桁の数字「XXXXXX」がProject IDである。次に自分のローカル環境にそのcloudlatex連携をするためのディレクトリを作る。

エクスプローラーからそのディレクトリを開き、
次にVSCode上で「Project Setting」をクリックすると「設定」のファイルが開く。ここでワークスペース設定から「Cloudlatex: Enabled」にチェックを入れ、「Cloudlatex: Project ID」に先ほど確認した数字を入力する。
「Project files have been synchronized!」という通知が出てくれば成功である。これでローカル環境に構築することなくリモート環境で\LaTeX のコンパイルができる。\footnote{しかしここで多くの場合エラーが発生することが多い。アカリクのcloudlatexのサーバーの問題かわからないが容量の大きいファイル等になるとサーバーと接続できないことが多い。この場合は時間をおくか又は新しくProject ID を入れなおすとよい。}\LaTeX のコンパイルは初期設定では、Ctrl+S を押して保存する。又はVSCodeのautosaveされたときにコンパイルされる設定になってる。またこの機能のみを使うlatexworkshop設定は\cite{cloudlatexの設定}を参照するとよい。
\footnote{また同時にCloud 上でも保存することができる。この場合だと保存したときに常にコンパイルするためにサーバーに負荷がかかりやすくよく接続が切れてしまう。接続が切れたときに\LaTeX のコンパイルエラーが出てしまう。この場合\LaTeX のエエラーなのか接続の問題なのかという見分けがつきにくくなる。またlatexworkshop標準搭載のエラーメッセージを吐くことはないため慣れないうちはリモート環境での執筆をオススメする。}

この機能によってVSCodeの強力な編集機能をフルに使うことができる。


\section{Ultra Math Preview\index{Ultra Math Preview}}
\subsection{Ultra Math Previewとは何か}
Ultra Math Previewは、LaTeX Workshopよりも強力な数式プレビューができる拡張機能である。
パッケージで定義されたコマンドもプレビューすることができる。
さらにスタイルをカスタマイズすることができるため、LaTeX Workshop 標準のプレビューよりもより利便性が高いものになっている。
このプレビューはMarkdownでも用いることができる。
\begin{itemize}
  \item 数式を打つとプレビューが即座に出てくる
  \item LaTeX と Markdown で同じマクロがプレビューに使える
  \item プレビューが透過できる
  \item プレビューの上からその下にある文字をクリックすることができる
\end{itemize}
\subsection{Ultra Math Previewの設定}
setting.jsonの\verb|{}|の中に次を入れることでlatexworkshopが対応していないパッケージの数式のレンダリングをすることができる。\cite{UltraMathPreview}
\begin{lstlisting}[caption={Ultra Math Preview}]
  "umath.preview.renderer": "mathjax",
"umath.preview.macros": [
		"\\require{physics}",
		"\\require{HTML}",
		"\\require{mathtools}",
		"\\require{mhchem}",
		"\\require{empheq}",
    "\\scriptsize{}",
    "\\newcommand{\\bm}[1]{\\boldsymbol{#1}}"]
	"umath.preview.position": "top",
	"umath.preview.customCSS": [
		"background-color: rgba(0, 0, 0, 1);" ,
	],
\end{lstlisting}
\subsection{Ultra Math Previewの設定の解説}
設定の意味について記述する。
\begin{description}
  \item[umath.preview.toggleMathPreview] プレビューを出すか出さないかを制御することができる。
  \item[umath.preview.renderer] レンダリング（変換）に MathJax を使うか KaTeX を使うかを選択することができる。
  \item[umath.preview.macros] LaTeX のマクロを定義してレンダリングすることができる。
  \item[umath.preview.position] プレビューを出す位置を変えることができる。
  \item[umath.preview.customCSS]  プレビューの見た目を変えるCSS
  \item[umath.preview.closeAllPreview]  表示されたプレビューを非表示にすることができる。デフォルトではEscapeキーを押すことで非表示にすることができる。 
\end{description}
 
\subsubsection{umath.preview.macros}
 LaTeXworkshopでも数式の表示は可能だが拡張性は低い。しかし、この拡張機能は、\verb|\newcommand|で記述することができるマクロを表示することができる。
 \begin{description}
  \item[require+extension名] このコマンドはMathJaxの固有のコマンドであり\LaTeX のパッケージのコマンドをレンダリングすることができるものである。
  \item[scriptsize] このコマンドは、UltraMathPreviewの表示を小さくすることができるコマンドである。これを使うことで表示サイズがpdfと同レベルになり全体が見やすくなる。
  \item[bmの定義] このコマンドは、bmパッケージの\verb|\bm|をレンダリングするために必要なものである。このコマンドは\verb|\bm|を\verb|\newcommand|で定義している。
 \end{description}
 UltraMathPreviewは定義をしてやればMathjaxに入っていないパッケージでもよく使うのものであればレンダリングすることができる。マクロの制作方法については\cite{美文書本}に詳しい。
 \subsubsection{umath.preview.position}
 ホバーの出す位置を変更することができる。ホバーの出す位置は
 \verb|"top"|または\verb|"bottom"|である。

 \subsubsection{umath.preview.customCSS}
 この設定は、プレビューの背景の色を変更することができる。
 \begin{lstlisting}[caption=color,label=color]
  "umath.preview.customCSS": [
		"background-color: rgba(0, 0, 0, 1);" ,
	],
 \end{lstlisting}
について、\verb|rgba(0, 0, 0, 1)|の引数を変更することで色を変化させることができる。左から順にred,green,blueであり、最後の数が透過率である。
この設定は黒色で透過なしになっている。ライトモードの人は\verb|rgba(255,255 ,255 , 1)|等にするとよい。


\section{\LaTeX 表制作}
\subsection{Table Generator\index{Table Generator}}
Table Generator\index{Table Generator}
は、\LaTeX での表を書く際に非常に有用なサイトである。このサイトではwordとほとんど同等の環境のGUIを用いることで\LaTeX 記法での表に変換してくれるサイトである。
\url{https://www.tablesgenerator.com/}\cite{Tablegenerater}で書くことができる。さらにこれはhtml等にも対応しているなどさまざまなマークアップ言語に対応している。

またCSVファイルの読み込みもすることができる。(\cite{tablesgeneratorabout}参照。)
\subsection{csv2tabular\index{csv2tabular}}
csv2tabularはexcel形式の表や、excelの表をコピペするだけで\LaTeX 形式の表に変換してくれる外部ツールである。これは、レポートの制作の時などでも便利である。このサイトは、\cite{csv2tabular}
\url{https://rra.yahansugi.com/scriptapplet/csv2tabular/}から見ることができる。またこの表は、tabular形式になるが環境名は表示されないので、次の環境を加える必要がある。
\begin{lstlisting}
  \begin{table}[h]
    \caption{キャプション名を書く}
    \label{ラベル名を書く}
    \centering
     \begin{tabular}{clll}% ここは中央ぞろえまたは左右ぞろえを決める。
      % ここに変換したコードを載せる。
    \end{tabular}
  \end{table}
\end{lstlisting}
のように書く必要がある。(\cite{csv2tabularの使い方}参照)また、Table Generatorのように、セルの結合等には対応していないため、形式的にまとまっているデータに対しては有効であるが、複雑な表は処理が難しい、複雑な表を書く場合はTable Generatorを使う方がよい。

\section{テキスト校正くん\index{テキスト校正くん}}
テキスト校正くんは、texファイルやmdファイル等の日本語文章を校閲することができる。これはインストールするだけで利用できる。例えば「です・ます」調と「だ・である」調の混在等を教えてくれる。

\section{\LaTeX 数式コマンドを手書きで打つ}
\subsection{Myscript mathとは何か}
\LaTeX コマンドを打つのが面倒だったり数式が非常に長く文字よりも手で書いた方が早く書けるときには
\url{https://webdemo.myscript.com/views/math/index.html}のサイトを使うとよい。このサイトはMyscript(\cite{Myscript}参照)が運営しているサイトでありApple Pencilや手書きで書いた文字を認識し、\LaTeX 形式の数式コマンドに変換してくれるウエブ上のサービスである。無料で使うことができる。
\subsection{Myscript Mathの使い方}
このサイトではpple Pencilや手書きで書いた文字を認識し\LaTeX コマンドを生成できる。また簡単な数式の場合はグラフ描画することができる。


\section{キーボードショートカット}
\subsection{キーボードショートカットとは何か？}
キーボードショートカット\index{キーボードショートカット}とはWindows やアプリケーションの機能を選択するような操作を、マウスやタッチパッドではなくキーボードの複数のキーを組み合わせて行う操作のことである。この操作を覚えることでさまざまなPC上で行う操作をマウス無しで行うことができるようになり、より早くさまざまなタスクを遂行できるようになる。\footnote{マウスでの操作が早い場合も多々ある。例えばpowerpoint等のGUIであるソフトである。このようなグラフィック中心のソフトウェアはマウスでの操作の方がよい。逆にVS Codeはその気になればほとんどの操作をコマンドで遂行することができる。このようなマウスを使うべき操作と使う必要のないコマンド操作の区別をつけることはPCを扱ううえで早く作業できるかできないかの違いになる。}

ここではVS Codeのキーボードショートカットの設定の仕方について記述する。
\subsection{キーボードショートカットの変更方法}
\subsubsection{キーボードショートカットの開き方}
キーボードショートカットの変更方法には３通りの開きかたがある。
\begin{description}
  \item[方法１] 左下の設定からキーボードショートカットを選択
  \item[方法２] Ctrl+K Ctrl+Sを押す
  \item[方法３] コマンドパレット Ctrl+shift+P からpreferences:Open keyboard Shortcutsまたは、preferences:Open keyboard Shortcuts(json)を選択する。
\end{description}
これでキーボードショートカットの設定画面に移る。
\subsection{キーボードショートカットの設定方法(規定の方法)}
キーボードショートカットの設定画面(jsonでないほう)を表示すると、コマンドが設定されている場所とされていない操作がある。

コマンドが定義されていないところを選択してエンターキー又はクリックをするとキーバインドの設定画面に移る。この際にショートカットにしたいキーを打つことでその操作のショートカットキーを定義することができる。\footnote{キーボードショートカットの設定はソースからデフォルトかユーザー定義かということがわかるようになっている。}

この設定画面からキーボードショートカットをすぐに確認できるためにすぐに公式ドキュメントを検索するまでもないキーボードショートカットの検索にも使うことができる。
\subsection{キーボードショートカットの設定方法(JSON) }
キーボードショートカットの設定はJSONファイルからも行うことができる。この場合はネットから必要なキーバインドの定義を持ってくるとき等に有用なやり方になる。キーボードショートカットの記述方法は次のようになる。より詳細なキーボードショートカットの方法は以下のように行う。
\begin{lstlisting}[caption={キーボードショートカットの変更方法(json)}]
  // 既定値を上書きするには、このファイル内にキー バインドを挿入しますauto[]
[
  {
    "key": "cmd+n",
    "command": "explorer.newFile",
    "when": "explorerViewletFocus"
  },
]
\end{lstlisting}

このように、\verb|"key"|には、キーバインドを打ち込み、\verb|"command"|には拡張機能またはこのVS Codeのシステム自体に設定されている機能を記述する。

次に\verb|"when"|はそのキーバインドがいつどのようなときにそのキーバインドを打ったときに其のコマンドを使用するのかということを決めることができる。

またこの\verb|"when"|を設定する際には、VS Codeの公式ドキュメントである
\url{https://code.visualstudio.com/docs/getstarted/keybindings#_when-clause-contexts}で見つけるとよい。
この中で\url{https://code.visualstudio.com/api/references/when-clause-contexts#conditional-operators  }
が自分の状況にあったものが見つかると思う。(\cite{キーボードショートカット変更方法}\cite{キーボードショートカット変更方法json}等、または公式ドキュメント\cite{VSCodeの公式ドキュメント}参照)

またキーバインドを簡単に表示する方法としてkeybindings.jsonファイルを開いているときにCtrl+K Ctrl+K のキーを押すと次のコマンドが表示される。残りはユーザーが\verb|"command","when"|を記述すればよい。
\begin{lstlisting}[caption={keybindings.json}]
  {
  "key": "入力したキー",
  "command": "commandId",
  "when": "editorTextFocus"
}
\end{lstlisting}
% \section{Git 連携}
% VS Code はGitというバージョン管理システムと容易に連携させることができるようになっており、巨大な文書制作でのバージョン管理が行える。
% そしてGit はVS Code上のボタン操作で直感的に操作することができる。
% これはローカル環境にバージョン管理のためのリポジトリを生成できる。
% これによりバージョン管理が非常に簡単になりさらにどこを変更したのかということが
% 非常に簡単にわかる。
% したがって今までCtrl+z で前の状態に戻っていたと思うが、
% セーブするとその前以上には戻ることができなかった状況から
% これは理論的には無限の過去の状態に戻すことができる状態になる。
% なおかつローカルにもオンライン（GitHub）
% として共同作業をオンラインですることができたり、また全世界に公開して
% 共同作業ができたりする。
% このように複数人でおこなう文書やプログラミング制作で大いに役立つ機能である。
% % どんなソフトウェア、サービスであるかよりも何ができるかに力点を置いた説明になっているため、
% % 少し分かりにくいような気もするがどうだろうか？ 
% % 用語をなるべく使わないようにした説明にはなっているものの、塩梅が難しいところである。

% \subsection{Git の導入}
% git はVS Codeの3つ目のタブにある丸が3つつながっているようなタブを
% クリックするとGitの導入を促すようなものがあるのでそれをクリックして
% Git のソフトウェアをGit のホームページからダウンロードする。

% \subsection{GitHub の導入}
% GitHub はgitと連携してネット上にリポジトリを生成することできる。
% GitHub は次のサイトから自分のメールアドレスを登録するだけで無制限に使うことができる。
% \footnote{ついでに言うと学生であればProプランが無料である。ぜひ有効活用しよう。}
% \url{https://github.com}

% \subsection{latexindent}
% \LaTeX のソースを自動で成形してくれるツール。これは、ソースに自動で空白等を
% 入れてくれる環境がTeX Liveにデフォルトで入っている。
% latexindent はVS Code上で、shift+Alt+Fをするとできる。
% これはitemize環境等に空白を入れて見やすくする機能がある。
% 下調べができたら追記

% \part{markdownk解説}
% \section{markdownとは何か？}
% この資料の付録は、markdown記法により書いている。markdownとは、\LaTeX と同様のマークアップ言語である。この言語はhtml記法と同じような性質を持つが記法をマスターするために必要な覚えるべきコマンドが非常に少ない。
% markdownの特色には
% \begin{itemize}
%   \item 手軽に文章構造を明示できること
%   \item 簡単で、覚えやすいこと
%   \item 読み書きに特別なアプリを必要としないこと
%   \item それでいて、対応アプリを使えば快適に読み書きできること
% \end{itemize}
% などがある.Markdownはジョン・グルーバー（John Gruber）によって2004年に開発され、最初は \url{http://daringfireball.net/projects/markdown/} で公開された。その後、多くの開発者の手を経ながら発展した。
% LaTeXのインストールとは無関係なので別ファイルに記述する

% \section{markdownとtexファイルの変換}

\appendix
\section{Windowsショートカットキー}
\subsection{ショートカットキーについて}
VS Codeではさまざまなショートカットが存在する。しかし、それをより活用し、ひいてはPC全体の効率的な活用を目指すことができる。例えば、マウスを使う場合と比べて時間効率では、年間120時間の時短が見込める等の報告がある。(\cite{キーボードショートカット時間効率}などを参照。)

ここではWindowsの起動からVS Code,ブラウザでのショートカットについて記述する。


\section{ショートカットキー一覧}
ショートカットキーは一つのキーのみではなく複数キーの組む合わせも存在する。
\begin{center}
  \begin{tabular}{ll} \hline
    コマンド                            & 機能                    \\
    \hline
    Alt+Z                           & wordwrapの変更           \\
    Ctrl+Alt+B                      & ビルドを実行する              \\
    Ctrl+Alt+V                      & pdfviewer を起動する       \\
    Ctrl+click                      & SyncTeXの利用（pdf側）      \\
    Ctrl+Alt+J                      & SyncTeXの利用（コード側）      \\
    Ctrl+Hキー                        & 置換パレットの表示             \\
    Crl+Alt+Enter                   & 置換の全置換                \\
    Ctrl+/                          & 行のコメントアウト機能（全言語共通）    \\
    Ctrl+@                          & VS Codeのターミナルの起動      \\
    Ctrl+Shift+X                    & 拡張機能タブを開く             \\
    Shift+Alt+F                     & latexindentを実行する      \\
    Ctrl+Space                      & コード補完を再表示             \\
    Ctrl+Shift+M                    & \LaTeX のエラーメッセージを表示する \\
    Ctrl+shift+M                    & 数式環境で数式のプレビューを表示する    \\
    Ctrl+B                          & サイドバーの表示の設定           \\
    Ctrl+Shift+\verb|+| or \verb|-| & ズームの程度を調整する           \\
    Ctrl+K F                        & ワークスペースを閉じる           \\
    Ctrl+shift+L                    & マルチカーソル(同じ文字)         \\
    Ctrl+K Z                        & 禅モード(Escで取り消し)        \\
    \hline
  \end{tabular}
\end{center}

次の参考文献は、
この資料を書き上げるために用いた資料一覧である。
この資料を読み通すことができたならば、
きっとこれらのサイトも読むことができるだろう。
さらに便利な使い方や、自分なりの設定をすることもできるだろう。

良い\LaTeX ライフを

happy \LaTeX ing
\printindex
\nocite{*}
\bibliographystyle{unsrt}
\bibliography{refernce}

\end{document}
